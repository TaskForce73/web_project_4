!function(){"use strict";var e={730:function(e,t,s){e.exports=s.p+"2f8a4cd99a9a7a10b10b.png"},14:function(e,t,s){e.exports=s.p+"4e8e0a1d604782a0dff8.svg"}},t={};function s(n){var r=t[n];if(void 0!==r)return r.exports;var i=t[n]={exports:{}};return e[n](i,i.exports,s),i.exports}s.p="",function(){function e(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class t{constructor(t,s,n,r,i){e(this,"_getTemplate",(()=>(this._element=document.querySelector(this._cardSelector).content.querySelector(".element").cloneNode(!0),this._element))),e(this,"removeCard",(()=>{this._element.remove(),this._element=null})),e(this,"_handleLikeButton",(()=>{this._likeButton.classList.toggle("element__button_active")})),e(this,"_setEventListeners",(()=>{this._elementBin=this._element.querySelector(".element__bin"),this._elementBin.addEventListener("click",(()=>{this._handleDeleteButton(this._id)})),this._likeButton.addEventListener("click",this._handleLikeButton),this._elementPicture.addEventListener("click",(()=>{this._handleCardClick(this._name,this._link)}))})),e(this,"generateCard",(()=>(this._element=this._getTemplate(),this._likeButton=this._element.querySelector(".element__button"),this._elementPicture=this._element.querySelector(".element__picture"),this._setEventListeners(),this._elementPicture.src=this._link,this._elementPicture.alt="Photo of ".concat(this._name),this._element.querySelector(".element__header").textContent=this._name,this._element))),this._name=t.name,this._link=t.link,this._cardSelector=s,this._handleCardClick=n,this._handleDeleteButton=r,this._id=t._id,this._ownerId=t.owner._id,this._userId=i,console.log("id",this._ownerId)}hideElementBin(){this._ownerId!==this._userId&&(this._elementBin=this._element.querySelector(".element__bin").style.display="none")}}function n(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class r{constructor(e){n(this,"close",(()=>{this._popup.classList.remove("popup_open"),document.removeEventListener("keydown",this._handleEscapeClose)})),n(this,"_handleEscapeClose",(e=>{"Escape"===e.key&&this.close()})),this._popup=document.querySelector(e)}open(){this._popup.classList.add("popup_open"),document.addEventListener("keydown",this._handleEscapeClose)}setEventListeners(){this._popup.addEventListener("mousedown",(e=>{(e.target.classList.contains("popup_open")||e.target.classList.contains("popup__close"))&&this.close()}))}}class i extends r{constructor(e,t){super(e),this._handleSubmit=t,this._form=this._popup.querySelector(".popup__form")}_getInputValues(){const e={};return[...this._form.querySelectorAll(".popup__input")].forEach((t=>{e[t.name]=t.value})),e}setEventListeners(){this._form.addEventListener("submit",(e=>{e.preventDefault(),this._handleSubmit(this._getInputValues()),this.close()})),super.setEventListeners()}close(){this._form.reset(),super.close()}}class o{constructor(e,t){let{items:s,renderer:n}=e;this._items=s,this._renderer=n,this._container=document.querySelector(t)}addItem(e){this._container.prepend(e)}render(){this._items.forEach((e=>{this._renderer(e)}))}}function l(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class a{constructor(e,t){l(this,"_showInputError",(e=>{this._errorElement=this._formElement.querySelector(".".concat(e.id,"-error")),e.classList.add(this._inputErrorClass),this._errorElement.textContent=e.validationMessage,this._errorElement.classList.add(this._errorClass)})),l(this,"_hideInputError",(e=>{this._errorElement=this._formElement.querySelector(".".concat(e.id,"-error")),e.classList.remove(this._inputErrorClass),this._errorElement.classList.remove(this._errorClass),this._errorElement.textContent=""})),l(this,"_checkInputValidity",(e=>{e.validity.valid?this._hideInputError(e):this._showInputError(e)})),l(this,"_hasInvalidInput",(e=>Array.from(e).some((e=>!e.validity.valid)))),l(this,"_toggleButtonState",(()=>{this._hasInvalidInput(this._inputsList)?(this._elementButton.classList.add(this._inactiveButtonClass),this._elementButton.setAttribute("disabled",!0)):(this._elementButton.classList.remove(this._inactiveButtonClass),this._elementButton.removeAttribute("disabled"))})),l(this,"_setEventListeners",(()=>{this._inputsList=Array.from(this._formElement.querySelectorAll(this._inputSelector)),this._toggleButtonState(),this._inputsList.forEach((e=>{e.addEventListener("input",(()=>{this._checkInputValidity(e),this._toggleButtonState()}))}))})),l(this,"enableValidation",(()=>{this._formElement.addEventListener("submit",(e=>{e.preventDefault()})),this._setEventListeners()})),l(this,"resetValidation",(()=>{this._inputsList.forEach((e=>{this._hideInputError(e)})),this._toggleButtonState()})),this._inputSelector=e.inputSelector,this._submitButtonSelector=e.submitButtonSelector,this._inactiveButtonClass=e.inactiveButtonClass,this._inputErrorClass=e.inputErrorClass,this._errorClass=e.errorClass,this._formElement=t,this._elementButton=this._formElement.querySelector(this._submitButtonSelector)}}const u={formSelector:".popup__form",inputSelector:".popup__input",submitButtonSelector:".popup__button",inactiveButtonClass:"popup__button_disabled",inputErrorClass:"popup__input_type_error",errorClass:"popup__error_visible"},c=(e,t)=>fetch(e,t).then((e=>e.ok?e.json():Promise.reject(e.statusText))).catch(console.log),_=new class{constructor(e){let{baseUrl:t,headers:s}=e;this._baseUrl=t,this._headers=s}getInitialCards(){return c("".concat(this._baseUrl,"/cards"),{headers:this._headers})}getUserInfo(){return c("".concat(this._baseUrl,"/users/me"),{headers:this._headers})}createCard(e){let{name:t,link:s}=e;return c("".concat(this._baseUrl,"/cards"),{method:"POST",headers:this._headers,body:JSON.stringify({name:t,link:s})})}deleteCard(e){return c("".concat(this._baseUrl,"/cards/").concat(e),{method:"DELETE",headers:this._headers})}}({baseUrl:"https://around.nomoreparties.co/v1/group-12",headers:{authorization:"32b9efa0-6f35-4afe-975e-e3a6be43cfcb","Content-Type":"application/json"}});var h=s(14),p=s(730);const d=document.querySelector(".profile__plus"),m=document.querySelector(".popup__form"),f=document.querySelector(".profile__edit"),v=document.querySelector(".popup__form_second"),b=document.querySelector(".elements__list"),E=document.querySelector(".popup__input-name"),S=document.querySelector(".popup__input-about");let y;document.getElementById("around-the-us").src=h,document.getElementById("profile-image").src=p;const g=new a(u,v);g.enableValidation();const L=new a(u,m);L.enableValidation();const C=new class extends r{setAction(e){this._submitHandler=e,this._form=this._popup.querySelector(".popup__form")}_getInputValues(){const e={};return[...this._form.querySelectorAll(".popup__input")].forEach((t=>{e[t.name]=t.value})),e}setEventListeners(){this._popup.addEventListener("submit",(e=>{e.preventDefault(),this._submitHandler(this._getInputValues()),this.close()})),super.setEventListeners()}}(".popup_card_remover");C.setEventListeners();const B=new class extends r{open(e,t){const s=this._popup.querySelector(".popup__image");this._popup.querySelector(".popup__description").textContent=e,s.alt="Photo of ".concat(e),s.src=t,super.open()}}(".popup_big_image");B.setEventListeners();const I=new i(".popup_profile_adder",(e=>{w.setUserInfo(e)}));I.setEventListeners();const q=new i(".popup_card_publisher",(e=>{_.createCard({name:e.description,link:e.link}).then((e=>{k(e)}))}));q.setEventListeners();const k=e=>{const s=function(e){const s=new t(e,"#card-template",((e,t)=>B.open(e,t)),(e=>{C.open(),C.setAction((()=>{_.deleteCard(e).then((e=>{console.log("card deleted",e),s.removeCard()}))}))}),y),n=s.generateCard();return s.hideElementBin(),n}(e);b.prepend(s)};_.getUserInfo().then((e=>{y=e._id,w.setUserInfo({name:e.name,about:e.about})})),_.getInitialCards().then((e=>{new o({items:e,renderer:k},".elements__list").render()}));const w=new class{constructor(e){let{profileNameSelector:t,profileJobSelector:s}=e;this._profileName=document.querySelector(t),this._profileJob=document.querySelector(s)}getUserInfo(){return{name:this._profileName.textContent,job:this._profileJob.textContent}}setUserInfo(e){let{name:t,about:s}=e;this._profileName.textContent=t,this._profileJob.textContent=s}}({profileNameSelector:".profile__author",profileJobSelector:".profile__text"});f.addEventListener("click",(()=>{L.resetValidation(m),function(){const e=w.getUserInfo();E.value=e.name,S.value=e.job}(),I.open()})),d.addEventListener("click",(()=>{g.resetValidation(v),q.open()}))}()}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUFjdEssU0FBU0MsY0FBY21LLEdBRTVDekMsY0FDRSxNQUFPLENBQ0xwRyxLQUFNekIsS0FBS3VLLGFBQWEvSSxZQUN4QmlKLElBQUt6SyxLQUFLd0ssWUFBWWhKLGFBRzFCbUksWUFBWSxHQUFpQixJQUFqQixLQUFFbEksRUFBRixNQUFRMkksR0FBUyxFQUMzQnBLLEtBQUt1SyxhQUFhL0ksWUFBY0MsRUFDaEN6QixLQUFLd0ssWUFBWWhKLFlBQWM0SSxJSDRETCxDQUM1QkMsb0JBQXFCLG1CQUNyQkMsbUJBQW9CLG1CQTZCdEI5QixFQUFrQjVILGlCQUFpQixTQUFTLEtBQzFDc0ksRUFBcUJ3QixnQkFBZ0JuQyxHQVB2QyxXQUNFLE1BQU1vQyxFQUFXakIsRUFBUzdCLGNBQzFCYyxFQUFpQmpGLE1BQVFpSCxFQUFTbEosS0FDbENtSCxFQUFrQmxGLE1BQVFpSCxFQUFTRixJQUtuQ0csR0FDQW5CLEVBQVU5RyxVQUdaMkYsRUFBa0IxSCxpQkFBaUIsU0FBUyxLQUMxQ29JLEVBQWtCMEIsZ0JBQWdCakMsR0FDbENtQixFQUFhakgsVSIsInNvdXJjZXMiOlsid2VicGFjazovL3dlYl9wcm9qZWN0XzQvd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC93ZWJwYWNrL3J1bnRpbWUvcHVibGljUGF0aCIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL3NjcmlwdHMvY29tcG9uZW50cy9DYXJkLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvc2NyaXB0cy9jb21wb25lbnRzL1BvcHVwLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvc2NyaXB0cy9jb21wb25lbnRzL1BvcHVwV2l0aEZvcm0uanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9zY3JpcHRzL2NvbXBvbmVudHMvU2VjdGlvbi5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL3NjcmlwdHMvY29tcG9uZW50cy9Gcm9tVmFsaWRhdG9yLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvc2NyaXB0cy91dGlscy9jb25zdGFudHMuanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9zY3JpcHRzL2NvbXBvbmVudHMvQXBpLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvcGFnZXMvaW5kZXguanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9zY3JpcHRzL2NvbXBvbmVudHMvUG9wdXBXaXRoU3VibWl0LmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvc2NyaXB0cy9jb21wb25lbnRzL1BvcHVwV2l0aEltYWdlLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvc2NyaXB0cy9jb21wb25lbnRzL1VzZXJJbmZvLmpzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIFRoZSBtb2R1bGUgY2FjaGVcbnZhciBfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX18gPSB7fTtcblxuLy8gVGhlIHJlcXVpcmUgZnVuY3Rpb25cbmZ1bmN0aW9uIF9fd2VicGFja19yZXF1aXJlX18obW9kdWxlSWQpIHtcblx0Ly8gQ2hlY2sgaWYgbW9kdWxlIGlzIGluIGNhY2hlXG5cdHZhciBjYWNoZWRNb2R1bGUgPSBfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX19bbW9kdWxlSWRdO1xuXHRpZiAoY2FjaGVkTW9kdWxlICE9PSB1bmRlZmluZWQpIHtcblx0XHRyZXR1cm4gY2FjaGVkTW9kdWxlLmV4cG9ydHM7XG5cdH1cblx0Ly8gQ3JlYXRlIGEgbmV3IG1vZHVsZSAoYW5kIHB1dCBpdCBpbnRvIHRoZSBjYWNoZSlcblx0dmFyIG1vZHVsZSA9IF9fd2VicGFja19tb2R1bGVfY2FjaGVfX1ttb2R1bGVJZF0gPSB7XG5cdFx0Ly8gbm8gbW9kdWxlLmlkIG5lZWRlZFxuXHRcdC8vIG5vIG1vZHVsZS5sb2FkZWQgbmVlZGVkXG5cdFx0ZXhwb3J0czoge31cblx0fTtcblxuXHQvLyBFeGVjdXRlIHRoZSBtb2R1bGUgZnVuY3Rpb25cblx0X193ZWJwYWNrX21vZHVsZXNfX1ttb2R1bGVJZF0obW9kdWxlLCBtb2R1bGUuZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyk7XG5cblx0Ly8gUmV0dXJuIHRoZSBleHBvcnRzIG9mIHRoZSBtb2R1bGVcblx0cmV0dXJuIG1vZHVsZS5leHBvcnRzO1xufVxuXG4iLCJfX3dlYnBhY2tfcmVxdWlyZV9fLnAgPSBcIlwiOyIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIENhcmQge1xuICBjb25zdHJ1Y3RvcihkYXRhLCBjYXJkU2VsZWN0b3IsIGhhbmRsZUNhcmRDbGljaywgaGFuZGxlRGVsZXRlQnV0dG9uLCB1c2VySWQpIHtcbiAgICB0aGlzLl9uYW1lID0gZGF0YS5uYW1lO1xuICAgIHRoaXMuX2xpbmsgPSBkYXRhLmxpbms7XG4gICAgdGhpcy5fY2FyZFNlbGVjdG9yID0gY2FyZFNlbGVjdG9yO1xuICAgIHRoaXMuX2hhbmRsZUNhcmRDbGljayA9IGhhbmRsZUNhcmRDbGljaztcbiAgICB0aGlzLl9oYW5kbGVEZWxldGVCdXR0b24gPSBoYW5kbGVEZWxldGVCdXR0b247XG4gICAgdGhpcy5faWQgPSBkYXRhLl9pZDtcbiAgICB0aGlzLl9vd25lcklkID0gZGF0YS5vd25lci5faWQ7XG4gICAgdGhpcy5fdXNlcklkID0gdXNlcklkO1xuICAgIGNvbnNvbGUubG9nKFwiaWRcIiwgdGhpcy5fb3duZXJJZCk7XG4gIH1cblxuICBfZ2V0VGVtcGxhdGUgPSAoKSA9PiB7XG4gICAgdGhpcy5fZWxlbWVudCA9IGRvY3VtZW50XG4gICAgICAucXVlcnlTZWxlY3Rvcih0aGlzLl9jYXJkU2VsZWN0b3IpXG4gICAgICAuY29udGVudC5xdWVyeVNlbGVjdG9yKFwiLmVsZW1lbnRcIilcbiAgICAgIC5jbG9uZU5vZGUodHJ1ZSk7XG4gICAgcmV0dXJuIHRoaXMuX2VsZW1lbnQ7XG4gIH07XG5cbiAgcmVtb3ZlQ2FyZCA9ICgpID0+IHtcbiAgICBjb25zdCBjYXJkID0gdGhpcy5fZWxlbWVudDtcbiAgICBjYXJkLnJlbW92ZSgpO1xuICAgIHRoaXMuX2VsZW1lbnQgPSBudWxsO1xuICB9O1xuXG4gIF9oYW5kbGVMaWtlQnV0dG9uID0gKCkgPT4ge1xuICAgIHRoaXMuX2xpa2VCdXR0b24uY2xhc3NMaXN0LnRvZ2dsZShcImVsZW1lbnRfX2J1dHRvbl9hY3RpdmVcIik7XG4gIH07XG5cbiAgX3NldEV2ZW50TGlzdGVuZXJzID0gKCkgPT4ge1xuICAgIHRoaXMuX2VsZW1lbnRCaW4gPSB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuZWxlbWVudF9fYmluXCIpO1xuICAgIHRoaXMuX2VsZW1lbnRCaW4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgICAgIHRoaXMuX2hhbmRsZURlbGV0ZUJ1dHRvbih0aGlzLl9pZCk7XG4gICAgfSk7XG4gICAgdGhpcy5fbGlrZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgdGhpcy5faGFuZGxlTGlrZUJ1dHRvbik7XG4gICAgdGhpcy5fZWxlbWVudFBpY3R1cmUuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgICAgIHRoaXMuX2hhbmRsZUNhcmRDbGljayh0aGlzLl9uYW1lLCB0aGlzLl9saW5rKTtcbiAgICB9KTtcbiAgfTtcblxuICBnZW5lcmF0ZUNhcmQgPSAoKSA9PiB7XG4gICAgdGhpcy5fZWxlbWVudCA9IHRoaXMuX2dldFRlbXBsYXRlKCk7XG4gICAgdGhpcy5fbGlrZUJ1dHRvbiA9IHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5lbGVtZW50X19idXR0b25cIik7XG4gICAgdGhpcy5fZWxlbWVudFBpY3R1cmUgPSB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuZWxlbWVudF9fcGljdHVyZVwiKTtcbiAgICB0aGlzLl9zZXRFdmVudExpc3RlbmVycygpO1xuICAgIHRoaXMuX2VsZW1lbnRQaWN0dXJlLnNyYyA9IHRoaXMuX2xpbms7XG4gICAgdGhpcy5fZWxlbWVudFBpY3R1cmUuYWx0ID0gYFBob3RvIG9mICR7dGhpcy5fbmFtZX1gO1xuICAgIHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5lbGVtZW50X19oZWFkZXJcIikudGV4dENvbnRlbnQgPSB0aGlzLl9uYW1lO1xuICAgIHJldHVybiB0aGlzLl9lbGVtZW50O1xuICB9O1xuXG4gIGhpZGVFbGVtZW50QmluICgpIHtcbiAgICBpZih0aGlzLl9vd25lcklkICE9PSB0aGlzLl91c2VySWQpIHtcbiAgICAgIHRoaXMuX2VsZW1lbnRCaW4gPSB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuZWxlbWVudF9fYmluXCIpLnN0eWxlLmRpc3BsYXkgPSBcIm5vbmVcIlxuICAgIH0gXG4gIH1cbn1cbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwIHtcbiAgY29uc3RydWN0b3IocG9wdXBTZWxlY3Rvcikge1xuICAgIHRoaXMuX3BvcHVwID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihwb3B1cFNlbGVjdG9yKTtcbiAgfVxuICBvcGVuKCkge1xuICAgIHRoaXMuX3BvcHVwLmNsYXNzTGlzdC5hZGQoXCJwb3B1cF9vcGVuXCIpO1xuICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIHRoaXMuX2hhbmRsZUVzY2FwZUNsb3NlKTtcbiAgfVxuXG4gIGNsb3NlID0gKCkgPT4ge1xuICAgIHRoaXMuX3BvcHVwLmNsYXNzTGlzdC5yZW1vdmUoXCJwb3B1cF9vcGVuXCIpO1xuICAgIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIHRoaXMuX2hhbmRsZUVzY2FwZUNsb3NlKTtcbiAgfTtcblxuICBzZXRFdmVudExpc3RlbmVycygpIHtcbiAgICB0aGlzLl9wb3B1cC5hZGRFdmVudExpc3RlbmVyKFwibW91c2Vkb3duXCIsIChlKSA9PiB7XG4gICAgICBpZiAoXG4gICAgICAgIGUudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucyhcInBvcHVwX29wZW5cIikgfHxcbiAgICAgICAgZS50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKFwicG9wdXBfX2Nsb3NlXCIpXG4gICAgICApIHtcbiAgICAgICAgdGhpcy5jbG9zZSgpO1xuICAgICAgfVxuICAgIH0pO1xuICB9XG5cbiAgX2hhbmRsZUVzY2FwZUNsb3NlID0gKGUpID0+IHtcbiAgICBpZiAoZS5rZXkgPT09IFwiRXNjYXBlXCIpIHtcbiAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICB9XG4gIH07XG59XG4iLCJpbXBvcnQgUG9wdXAgZnJvbSBcIi4vUG9wdXBcIjtcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwV2l0aEZvcm0gZXh0ZW5kcyBQb3B1cCB7XG4gIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IsIGhhbmRsZVN1Ym1pdCkge1xuICAgIHN1cGVyKHBvcHVwU2VsZWN0b3IpO1xuICAgIHRoaXMuX2hhbmRsZVN1Ym1pdCA9IGhhbmRsZVN1Ym1pdDtcbiAgICB0aGlzLl9mb3JtID0gdGhpcy5fcG9wdXAucXVlcnlTZWxlY3RvcihcIi5wb3B1cF9fZm9ybVwiKTtcbiAgfVxuICBfZ2V0SW5wdXRWYWx1ZXMoKSB7XG4gICAgY29uc3QgaW5wdXRWYWx1ZXMgPSB7fTtcbiAgICBjb25zdCBpbnB1dHMgPSBbLi4udGhpcy5fZm9ybS5xdWVyeVNlbGVjdG9yQWxsKFwiLnBvcHVwX19pbnB1dFwiKV07XG4gICAgaW5wdXRzLmZvckVhY2goKGlucHV0KSA9PiB7XG4gICAgICBpbnB1dFZhbHVlc1tpbnB1dC5uYW1lXSA9IGlucHV0LnZhbHVlO1xuICAgIH0pO1xuICAgIHJldHVybiBpbnB1dFZhbHVlcztcbiAgfVxuXG4gIHNldEV2ZW50TGlzdGVuZXJzKCkge1xuICAgIHRoaXMuX2Zvcm0uYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCAoZSkgPT4ge1xuICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgdGhpcy5faGFuZGxlU3VibWl0KHRoaXMuX2dldElucHV0VmFsdWVzKCkpO1xuICAgICAgdGhpcy5jbG9zZSgpO1xuICAgIH0pO1xuICAgIHN1cGVyLnNldEV2ZW50TGlzdGVuZXJzKCk7XG4gIH1cblxuICBjbG9zZSgpIHtcbiAgICB0aGlzLl9mb3JtLnJlc2V0KCk7XG4gICAgc3VwZXIuY2xvc2UoKTtcbiAgfVxufVxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgU2VjdGlvbiB7XG4gIGNvbnN0cnVjdG9yKHsgaXRlbXMsIHJlbmRlcmVyIH0sIGNvbnRhaW5lclNlbGVjdG9yKSB7XG4gICAgdGhpcy5faXRlbXMgPSBpdGVtcztcbiAgICB0aGlzLl9yZW5kZXJlciA9IHJlbmRlcmVyO1xuICAgIHRoaXMuX2NvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoY29udGFpbmVyU2VsZWN0b3IpO1xuICB9XG5cbiAgYWRkSXRlbShlbGVtZW50KSB7XG4gICAgdGhpcy5fY29udGFpbmVyLnByZXBlbmQoZWxlbWVudCk7XG4gIH1cblxuICByZW5kZXIoKSB7XG4gICAgdGhpcy5faXRlbXMuZm9yRWFjaCgoZGF0YSkgPT4ge1xuICAgICAgdGhpcy5fcmVuZGVyZXIoZGF0YSk7XG4gICAgfSk7XG4gIH1cbn1cbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIEZvcm1WYWxpZGF0b3Ige1xuICBjb25zdHJ1Y3RvcihzZXR0aW5ncywgZm9ybUVsZW1lbnQpIHtcbiAgICB0aGlzLl9pbnB1dFNlbGVjdG9yID0gc2V0dGluZ3MuaW5wdXRTZWxlY3RvcjtcbiAgICB0aGlzLl9zdWJtaXRCdXR0b25TZWxlY3RvciA9IHNldHRpbmdzLnN1Ym1pdEJ1dHRvblNlbGVjdG9yO1xuICAgIHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MgPSBzZXR0aW5ncy5pbmFjdGl2ZUJ1dHRvbkNsYXNzO1xuICAgIHRoaXMuX2lucHV0RXJyb3JDbGFzcyA9IHNldHRpbmdzLmlucHV0RXJyb3JDbGFzcztcbiAgICB0aGlzLl9lcnJvckNsYXNzID0gc2V0dGluZ3MuZXJyb3JDbGFzcztcbiAgICB0aGlzLl9mb3JtRWxlbWVudCA9IGZvcm1FbGVtZW50O1xuICAgIHRoaXMuX2VsZW1lbnRCdXR0b24gPSB0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKFxuICAgICAgdGhpcy5fc3VibWl0QnV0dG9uU2VsZWN0b3JcbiAgICApO1xuICB9XG5cbiAgX3Nob3dJbnB1dEVycm9yID0gKGlucHV0RWxlbWVudCkgPT4ge1xuICAgIHRoaXMuX2Vycm9yRWxlbWVudCA9IHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXG4gICAgICBgLiR7aW5wdXRFbGVtZW50LmlkfS1lcnJvcmBcbiAgICApO1xuICAgIGlucHV0RWxlbWVudC5jbGFzc0xpc3QuYWRkKHRoaXMuX2lucHV0RXJyb3JDbGFzcyk7XG4gICAgdGhpcy5fZXJyb3JFbGVtZW50LnRleHRDb250ZW50ID0gaW5wdXRFbGVtZW50LnZhbGlkYXRpb25NZXNzYWdlO1xuICAgIHRoaXMuX2Vycm9yRWxlbWVudC5jbGFzc0xpc3QuYWRkKHRoaXMuX2Vycm9yQ2xhc3MpO1xuICB9O1xuXG4gIF9oaWRlSW5wdXRFcnJvciA9IChpbnB1dEVsZW1lbnQpID0+IHtcbiAgICB0aGlzLl9lcnJvckVsZW1lbnQgPSB0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKFxuICAgICAgYC4ke2lucHV0RWxlbWVudC5pZH0tZXJyb3JgXG4gICAgKTtcbiAgICBpbnB1dEVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9pbnB1dEVycm9yQ2xhc3MpO1xuICAgIHRoaXMuX2Vycm9yRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2Vycm9yQ2xhc3MpO1xuICAgIHRoaXMuX2Vycm9yRWxlbWVudC50ZXh0Q29udGVudCA9IFwiXCI7XG4gIH07XG5cbiAgX2NoZWNrSW5wdXRWYWxpZGl0eSA9IChpbnB1dEVsZW1lbnQpID0+IHtcbiAgICBpZiAoIWlucHV0RWxlbWVudC52YWxpZGl0eS52YWxpZCkge1xuICAgICAgdGhpcy5fc2hvd0lucHV0RXJyb3IoaW5wdXRFbGVtZW50KTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5faGlkZUlucHV0RXJyb3IoaW5wdXRFbGVtZW50KTtcbiAgICB9XG4gIH07XG5cbiAgX2hhc0ludmFsaWRJbnB1dCA9IChpbnB1dHNMaXN0KSA9PiB7XG4gICAgY29uc3QgaW5wdXRzID0gQXJyYXkuZnJvbShpbnB1dHNMaXN0KTtcbiAgICByZXR1cm4gaW5wdXRzLnNvbWUoKGlucHV0RWxlbWVudCkgPT4ge1xuICAgICAgcmV0dXJuICFpbnB1dEVsZW1lbnQudmFsaWRpdHkudmFsaWQ7XG4gICAgfSk7XG4gIH07XG5cbiAgX3RvZ2dsZUJ1dHRvblN0YXRlID0gKCkgPT4ge1xuICAgIGlmICh0aGlzLl9oYXNJbnZhbGlkSW5wdXQodGhpcy5faW5wdXRzTGlzdCkpIHtcbiAgICAgIHRoaXMuX2VsZW1lbnRCdXR0b24uY2xhc3NMaXN0LmFkZCh0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcbiAgICAgIHRoaXMuX2VsZW1lbnRCdXR0b24uc2V0QXR0cmlidXRlKFwiZGlzYWJsZWRcIiwgdHJ1ZSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuX2VsZW1lbnRCdXR0b24uY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcbiAgICAgIHRoaXMuX2VsZW1lbnRCdXR0b24ucmVtb3ZlQXR0cmlidXRlKFwiZGlzYWJsZWRcIik7XG4gICAgfVxuICB9O1xuXG4gIF9zZXRFdmVudExpc3RlbmVycyA9ICgpID0+IHtcbiAgICB0aGlzLl9pbnB1dHNMaXN0ID0gQXJyYXkuZnJvbShcbiAgICAgIHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwodGhpcy5faW5wdXRTZWxlY3RvcilcbiAgICApO1xuICAgIHRoaXMuX3RvZ2dsZUJ1dHRvblN0YXRlKCk7XG4gICAgdGhpcy5faW5wdXRzTGlzdC5mb3JFYWNoKChpbnB1dEVsZW1lbnQpID0+IHtcbiAgICAgIGlucHV0RWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwiaW5wdXRcIiwgKCkgPT4ge1xuICAgICAgICB0aGlzLl9jaGVja0lucHV0VmFsaWRpdHkoaW5wdXRFbGVtZW50KTtcbiAgICAgICAgdGhpcy5fdG9nZ2xlQnV0dG9uU3RhdGUoKTtcbiAgICAgIH0pO1xuICAgIH0pO1xuICB9O1xuXG4gIGVuYWJsZVZhbGlkYXRpb24gPSAoKSA9PiB7XG4gICAgdGhpcy5fZm9ybUVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCAoZXZ0KSA9PiB7XG4gICAgICBldnQucHJldmVudERlZmF1bHQoKTtcbiAgICB9KTtcbiAgICB0aGlzLl9zZXRFdmVudExpc3RlbmVycygpO1xuICB9O1xuXG4gIHJlc2V0VmFsaWRhdGlvbiA9ICgpID0+IHtcbiAgICB0aGlzLl9pbnB1dHNMaXN0LmZvckVhY2goKGlucHV0RWxlbWVudCkgPT4ge1xuICAgICAgdGhpcy5faGlkZUlucHV0RXJyb3IoaW5wdXRFbGVtZW50KTtcbiAgICB9KTtcbiAgICB0aGlzLl90b2dnbGVCdXR0b25TdGF0ZSgpO1xuICB9O1xufVxuIiwiZXhwb3J0IHsgcGFnZVNldHRpbmdzIH07XG5cbi8qY29uc3QgaW5pdGlhbENhcmRzID0gW1xuICB7XG4gICAgbmFtZTogXCJZb3NlbWl0ZSBWYWxsZXlcIixcbiAgICBsaW5rOiBcImh0dHBzOi8vY29kZS5zMy55YW5kZXgubmV0L3dlYi1jb2RlL3lvc2VtaXRlLmpwZ1wiLFxuICB9LFxuICB7XG4gICAgbmFtZTogXCJMYWtlIExvdWlzZVwiLFxuICAgIGxpbms6IFwiaHR0cHM6Ly9jb2RlLnMzLnlhbmRleC5uZXQvd2ViLWNvZGUvbGFrZS1sb3Vpc2UuanBnXCIsXG4gIH0sXG4gIHtcbiAgICBuYW1lOiBcIkJhbGQgTW91bnRhaW5zXCIsXG4gICAgbGluazogXCJodHRwczovL2NvZGUuczMueWFuZGV4Lm5ldC93ZWItY29kZS9iYWxkLW1vdW50YWlucy5qcGdcIixcbiAgfSxcbiAge1xuICAgIG5hbWU6IFwiTGF0ZW1hclwiLFxuICAgIGxpbms6IFwiaHR0cHM6Ly9jb2RlLnMzLnlhbmRleC5uZXQvd2ViLWNvZGUvbGF0ZW1hci5qcGdcIixcbiAgfSxcbiAge1xuICAgIG5hbWU6IFwiVmFub2lzZSBOYXRpb25hbCBQYXJrXCIsXG4gICAgbGluazogXCJodHRwczovL2NvZGUuczMueWFuZGV4Lm5ldC93ZWItY29kZS92YW5vaXNlLmpwZ1wiLFxuICB9LFxuICB7XG4gICAgbmFtZTogXCJMYWdvIGRpIEJyYWllc1wiLFxuICAgIGxpbms6IFwiaHR0cHM6Ly9jb2RlLnMzLnlhbmRleC5uZXQvd2ViLWNvZGUvbGFnby5qcGdcIixcbiAgfSxcbl07XG4qL1xuY29uc3QgcGFnZVNldHRpbmdzID0ge1xuICBmb3JtU2VsZWN0b3I6IFwiLnBvcHVwX19mb3JtXCIsXG4gIGlucHV0U2VsZWN0b3I6IFwiLnBvcHVwX19pbnB1dFwiLFxuICBzdWJtaXRCdXR0b25TZWxlY3RvcjogXCIucG9wdXBfX2J1dHRvblwiLFxuICBpbmFjdGl2ZUJ1dHRvbkNsYXNzOiBcInBvcHVwX19idXR0b25fZGlzYWJsZWRcIixcbiAgaW5wdXRFcnJvckNsYXNzOiBcInBvcHVwX19pbnB1dF90eXBlX2Vycm9yXCIsXG4gIGVycm9yQ2xhc3M6IFwicG9wdXBfX2Vycm9yX3Zpc2libGVcIixcbn07XG5cbiIsImNvbnN0IGN1c3RvbUZldGNoID0gKHVybCwgaGVhZGVycykgPT4gXG5mZXRjaCh1cmwsIGhlYWRlcnMpXG4udGhlbihyZXMgPT4gcmVzLm9rID8gcmVzLmpzb24oKSA6IFByb21pc2UucmVqZWN0KHJlcy5zdGF0dXNUZXh0KSlcbi5jYXRjaChjb25zb2xlLmxvZylcblxuY2xhc3MgQXBpIHtcbiAgY29uc3RydWN0b3IoeyBiYXNlVXJsLCBoZWFkZXJzIH0pIHtcbiAgICB0aGlzLl9iYXNlVXJsID0gYmFzZVVybDtcbiAgICB0aGlzLl9oZWFkZXJzID0gaGVhZGVycztcbiAgfVxuXG4gIGdldEluaXRpYWxDYXJkcygpIHtcbiAgICByZXR1cm4gY3VzdG9tRmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHNgLCB7IFxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVyc1xuICAgICB9KVxuICB9XG5cbiAgZ2V0VXNlckluZm8oKSB7XG4gICAgcmV0dXJuIGN1c3RvbUZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L3VzZXJzL21lYCwgeyBcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnNcbiAgICAgfSlcbiAgfVxuXG4gIGNyZWF0ZUNhcmQoe25hbWUsIGxpbmt9KSB7XG4gICAgcmV0dXJuIGN1c3RvbUZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzYCwgeyBcbiAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgbmFtZSxcbiAgICAgICAgbGlua1xuICAgICAgfSlcbiAgICAgfSlcbiAgfVxuXG4gIGRlbGV0ZUNhcmQoY2FyZElkKSB7XG4gICAgcmV0dXJuIGN1c3RvbUZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzLyR7Y2FyZElkfWAsIHsgXG4gICAgICBtZXRob2Q6ICdERUxFVEUnLFxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcbiAgICAgfSlcbiAgfVxufVxuXG5leHBvcnQgY29uc3QgYXBpID0gbmV3IEFwaSh7XG4gIGJhc2VVcmw6IFwiaHR0cHM6Ly9hcm91bmQubm9tb3JlcGFydGllcy5jby92MS9ncm91cC0xMlwiLFxuICBoZWFkZXJzOiB7XG4gICAgYXV0aG9yaXphdGlvbjogXCIzMmI5ZWZhMC02ZjM1LTRhZmUtOTc1ZS1lM2E2YmU0M2NmY2JcIixcbiAgICBcIkNvbnRlbnQtVHlwZVwiOiBcImFwcGxpY2F0aW9uL2pzb25cIixcbiAgfSxcbn0pO1xuIiwiaW1wb3J0IFwiLi4vcGFnZXMvaW5kZXguY3NzXCI7XG5pbXBvcnQgQ2FyZCBmcm9tIFwiLi4vc2NyaXB0cy9jb21wb25lbnRzL0NhcmRcIjtcbmltcG9ydCBQb3B1cFdpdGhJbWFnZSBmcm9tIFwiLi4vc2NyaXB0cy9jb21wb25lbnRzL1BvcHVwV2l0aEltYWdlXCI7XG5pbXBvcnQgUG9wdXBXaXRoRm9ybSBmcm9tIFwiLi4vc2NyaXB0cy9jb21wb25lbnRzL1BvcHVwV2l0aEZvcm1cIjtcbmltcG9ydCBVc2VySW5mbyBmcm9tIFwiLi4vc2NyaXB0cy9jb21wb25lbnRzL1VzZXJJbmZvXCI7XG5pbXBvcnQgU2VjdGlvbiBmcm9tIFwiLi4vc2NyaXB0cy9jb21wb25lbnRzL1NlY3Rpb25cIjtcbmltcG9ydCBGb3JtVmFsaWRhdG9yIGZyb20gXCIuLi9zY3JpcHRzL2NvbXBvbmVudHMvRnJvbVZhbGlkYXRvclwiO1xuaW1wb3J0IFBvcHVwV2l0aFN1Ym1pdCBmcm9tIFwiLi4vc2NyaXB0cy9jb21wb25lbnRzL1BvcHVwV2l0aFN1Ym1pdFwiO1xuaW1wb3J0IHsgcGFnZVNldHRpbmdzIH0gZnJvbSBcIi4uL3NjcmlwdHMvdXRpbHMvY29uc3RhbnRzXCI7XG5pbXBvcnQgeyBhcGkgfSBmcm9tIFwiLi4vc2NyaXB0cy9jb21wb25lbnRzL0FwaVwiO1xuXG5jb25zdCBwbHVzUHJvZmlsZUJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fcGx1c1wiKTtcbmNvbnN0IHByb2ZpbGVGb3JtID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wb3B1cF9fZm9ybVwiKTtcbmNvbnN0IGVkaXRQcm9maWxlQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19lZGl0XCIpO1xuY29uc3QgY2FyZEZvcm0gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnBvcHVwX19mb3JtX3NlY29uZFwiKTtcbmNvbnN0IGVsZW1lbnRMaXN0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5lbGVtZW50c19fbGlzdFwiKTtcbmNvbnN0IHByb2ZpbGVJbnB1dE5hbWUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnBvcHVwX19pbnB1dC1uYW1lXCIpO1xuY29uc3QgcHJvZmlsZUlucHV0QWJvdXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnBvcHVwX19pbnB1dC1hYm91dFwiKTtcbmxldCB1c2VySWQ7XG5cbmltcG9ydCBoZWFkZXJTcmMgZnJvbSBcIi4uL2ltYWdlcy9oZWFkZXIuc3ZnXCI7XG5jb25zdCBoZWFkZXJJbWFnZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiYXJvdW5kLXRoZS11c1wiKTtcbmhlYWRlckltYWdlLnNyYyA9IGhlYWRlclNyYztcblxuaW1wb3J0IHByb2ZpbGVTcmMgZnJvbSBcIi4uL2ltYWdlcy9Db3VzdGVhdS5wbmdcIjtcbmNvbnN0IHByb2ZpbGVJbWFnZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwicHJvZmlsZS1pbWFnZVwiKTtcbnByb2ZpbGVJbWFnZS5zcmMgPSBwcm9maWxlU3JjO1xuXG5jb25zdCBjYXJkRm9ybVZhbGlkYXRvciA9IG5ldyBGb3JtVmFsaWRhdG9yKHBhZ2VTZXR0aW5ncywgY2FyZEZvcm0pO1xuY2FyZEZvcm1WYWxpZGF0b3IuZW5hYmxlVmFsaWRhdGlvbigpO1xuXG5jb25zdCBwcm9maWxlRm9ybVZhbGlkYXRvciA9IG5ldyBGb3JtVmFsaWRhdG9yKHBhZ2VTZXR0aW5ncywgcHJvZmlsZUZvcm0pO1xucHJvZmlsZUZvcm1WYWxpZGF0b3IuZW5hYmxlVmFsaWRhdGlvbigpO1xuXG5jb25zdCBjb25maXJtTW9kYWwgPSBuZXcgUG9wdXBXaXRoU3VibWl0KFwiLnBvcHVwX2NhcmRfcmVtb3ZlclwiKTtcbmNvbmZpcm1Nb2RhbC5zZXRFdmVudExpc3RlbmVycygpO1xuXG5jb25zdCBpbWFnZU1vZGFsID0gbmV3IFBvcHVwV2l0aEltYWdlKFwiLnBvcHVwX2JpZ19pbWFnZVwiKTtcbmltYWdlTW9kYWwuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcblxuY29uc3QgZWRpdE1vZGFsID0gbmV3IFBvcHVwV2l0aEZvcm0oXCIucG9wdXBfcHJvZmlsZV9hZGRlclwiLCAoZGF0YSkgPT4ge1xuICB1c2VySW5mby5zZXRVc2VySW5mbyhkYXRhKTtcbn0pO1xuZWRpdE1vZGFsLnNldEV2ZW50TGlzdGVuZXJzKCk7XG5cbmNvbnN0IGFkZENhcmRNb2RhbCA9IG5ldyBQb3B1cFdpdGhGb3JtKFwiLnBvcHVwX2NhcmRfcHVibGlzaGVyXCIsIChkYXRhKSA9PiB7XG4gIGFwaS5jcmVhdGVDYXJkKHsgbmFtZTogZGF0YS5kZXNjcmlwdGlvbiwgbGluazogZGF0YS5saW5rIH0pLnRoZW4oKGRhdGEpID0+IHtcbiAgICByZW5kZXJDYXJkKGRhdGEpO1xuICB9KTtcbn0pO1xuYWRkQ2FyZE1vZGFsLnNldEV2ZW50TGlzdGVuZXJzKCk7XG5cbmNvbnN0IHJlbmRlckNhcmQgPSAoZGF0YSkgPT4ge1xuICBjb25zdCBjYXJkID0gY3JlYXRlTmV3Q2FyZChkYXRhKTtcbiAgZWxlbWVudExpc3QucHJlcGVuZChjYXJkKTtcbn07XG5cbmFwaS5nZXRVc2VySW5mbygpLnRoZW4oKHJlcykgPT4ge1xuICB1c2VySWQgPSByZXMuX2lkO1xuICB1c2VySW5mby5zZXRVc2VySW5mbyh7IG5hbWU6IHJlcy5uYW1lLCBhYm91dDogcmVzLmFib3V0IH0pO1xufSk7XG5cbmFwaS5nZXRJbml0aWFsQ2FyZHMoKS50aGVuKChyZXMpID0+IHtcbiAgY29uc3Qgc2VjdGlvbiA9IG5ldyBTZWN0aW9uKFxuICAgIHtcbiAgICAgIGl0ZW1zOiByZXMsXG4gICAgICByZW5kZXJlcjogcmVuZGVyQ2FyZCxcbiAgICB9LFxuICAgIFwiLmVsZW1lbnRzX19saXN0XCJcbiAgKTtcbiAgc2VjdGlvbi5yZW5kZXIoKTtcbn0pO1xuXG5jb25zdCB1c2VySW5mbyA9IG5ldyBVc2VySW5mbyh7XG4gIHByb2ZpbGVOYW1lU2VsZWN0b3I6IFwiLnByb2ZpbGVfX2F1dGhvclwiLFxuICBwcm9maWxlSm9iU2VsZWN0b3I6IFwiLnByb2ZpbGVfX3RleHRcIixcbn0pO1xuXG5mdW5jdGlvbiBjcmVhdGVOZXdDYXJkKGRhdGEpIHtcbiAgY29uc3QgY2FyZCA9IG5ldyBDYXJkKFxuICAgIGRhdGEsXG4gICAgXCIjY2FyZC10ZW1wbGF0ZVwiLFxuICAgIChuYW1lLCBsaW5rKSA9PiBpbWFnZU1vZGFsLm9wZW4obmFtZSwgbGluayksXG4gICAgKGlkKSA9PiB7XG4gICAgICBjb25maXJtTW9kYWwub3BlbigpO1xuICAgICAgY29uZmlybU1vZGFsLnNldEFjdGlvbigoKSA9PiB7XG4gICAgICAgIGFwaS5kZWxldGVDYXJkKGlkKS50aGVuKChyZXMpID0+IHtcbiAgICAgICAgICBjb25zb2xlLmxvZyhcImNhcmQgZGVsZXRlZFwiLCByZXMpO1xuICAgICAgICAgIGNhcmQucmVtb3ZlQ2FyZCgpO1xuICAgICAgICB9KTtcbiAgICAgIH0pO1xuICAgIH0sIHVzZXJJZFxuICApXG4gIGNvbnN0IGNhcmRFbGVtZW50ID0gY2FyZC5nZW5lcmF0ZUNhcmQoKTtcbiAgY2FyZC5oaWRlRWxlbWVudEJpbigpO1xuICByZXR1cm4gY2FyZEVsZW1lbnQ7XG59XG5cbmZ1bmN0aW9uIGZpbGxQcm9maWxlRm9ybSgpIHtcbiAgY29uc3QgdXNlckRhdGEgPSB1c2VySW5mby5nZXRVc2VySW5mbygpO1xuICBwcm9maWxlSW5wdXROYW1lLnZhbHVlID0gdXNlckRhdGEubmFtZTtcbiAgcHJvZmlsZUlucHV0QWJvdXQudmFsdWUgPSB1c2VyRGF0YS5qb2I7XG59XG5cbmVkaXRQcm9maWxlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gIHByb2ZpbGVGb3JtVmFsaWRhdG9yLnJlc2V0VmFsaWRhdGlvbihwcm9maWxlRm9ybSk7XG4gIGZpbGxQcm9maWxlRm9ybSgpO1xuICBlZGl0TW9kYWwub3BlbigpO1xufSk7XG5cbnBsdXNQcm9maWxlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gIGNhcmRGb3JtVmFsaWRhdG9yLnJlc2V0VmFsaWRhdGlvbihjYXJkRm9ybSk7XG4gIGFkZENhcmRNb2RhbC5vcGVuKCk7XG59KTtcbiIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi9Qb3B1cFwiO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cFdpdGhTdWJtaXQgZXh0ZW5kcyBQb3B1cCB7XG5zZXRBY3Rpb24oYWN0aW9uKSB7XG50aGlzLl9zdWJtaXRIYW5kbGVyID0gYWN0aW9uXG50aGlzLl9mb3JtID0gdGhpcy5fcG9wdXAucXVlcnlTZWxlY3RvcihcIi5wb3B1cF9fZm9ybVwiKTtcbn1cbiAgICBcbl9nZXRJbnB1dFZhbHVlcygpIHtcbiAgICBjb25zdCBpbnB1dFZhbHVlcyA9IHt9O1xuICAgIGNvbnN0IGlucHV0cyA9IFsuLi50aGlzLl9mb3JtLnF1ZXJ5U2VsZWN0b3JBbGwoXCIucG9wdXBfX2lucHV0XCIpXTtcbiAgICBpbnB1dHMuZm9yRWFjaCgoaW5wdXQpID0+IHtcbiAgICAgIGlucHV0VmFsdWVzW2lucHV0Lm5hbWVdID0gaW5wdXQudmFsdWU7XG4gICAgfSk7XG4gICAgcmV0dXJuIGlucHV0VmFsdWVzO1xuICB9XG5cbnNldEV2ZW50TGlzdGVuZXJzKCkge1xuICAgIHRoaXMuX3BvcHVwLmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgKGUpID0+IHtcbiAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgIHRoaXMuX3N1Ym1pdEhhbmRsZXIodGhpcy5fZ2V0SW5wdXRWYWx1ZXMoKSk7XG4gICAgICB0aGlzLmNsb3NlKCk7XG4gICAgfSk7XG4gICAgc3VwZXIuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcbiAgfVxufSIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi9Qb3B1cFwiO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cFdpdGhJbWFnZSBleHRlbmRzIFBvcHVwIHtcbiAgb3BlbihuYW1lLCBsaW5rKSB7XG4gICAgY29uc3QgaW1hZ2UgPSB0aGlzLl9wb3B1cC5xdWVyeVNlbGVjdG9yKFwiLnBvcHVwX19pbWFnZVwiKTtcbiAgICBjb25zdCBjYXB0aW9uID0gdGhpcy5fcG9wdXAucXVlcnlTZWxlY3RvcihcIi5wb3B1cF9fZGVzY3JpcHRpb25cIik7XG4gICAgY2FwdGlvbi50ZXh0Q29udGVudCA9IG5hbWU7XG4gICAgaW1hZ2UuYWx0ID0gYFBob3RvIG9mICR7bmFtZX1gO1xuICAgIGltYWdlLnNyYyA9IGxpbms7XG4gICAgc3VwZXIub3BlbigpO1xuICB9XG59XG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBVc2VySW5mbyB7XG4gIGNvbnN0cnVjdG9yKHsgcHJvZmlsZU5hbWVTZWxlY3RvciwgcHJvZmlsZUpvYlNlbGVjdG9yIH0pIHtcbiAgICB0aGlzLl9wcm9maWxlTmFtZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IocHJvZmlsZU5hbWVTZWxlY3Rvcik7XG4gICAgdGhpcy5fcHJvZmlsZUpvYiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IocHJvZmlsZUpvYlNlbGVjdG9yKTtcbiAgfVxuICBnZXRVc2VySW5mbygpIHtcbiAgICByZXR1cm4ge1xuICAgICAgbmFtZTogdGhpcy5fcHJvZmlsZU5hbWUudGV4dENvbnRlbnQsXG4gICAgICBqb2I6IHRoaXMuX3Byb2ZpbGVKb2IudGV4dENvbnRlbnQsXG4gICAgfTtcbiAgfVxuICBzZXRVc2VySW5mbyh7IG5hbWUsIGFib3V0IH0pIHtcbiAgICB0aGlzLl9wcm9maWxlTmFtZS50ZXh0Q29udGVudCA9IG5hbWU7XG4gICAgdGhpcy5fcHJvZmlsZUpvYi50ZXh0Q29udGVudCA9IGFib3V0O1xuICB9XG59XG4iXSwibmFtZXMiOlsiX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fIiwiX193ZWJwYWNrX3JlcXVpcmVfXyIsIm1vZHVsZUlkIiwiY2FjaGVkTW9kdWxlIiwidW5kZWZpbmVkIiwiZXhwb3J0cyIsIm1vZHVsZSIsIl9fd2VicGFja19tb2R1bGVzX18iLCJwIiwiQ2FyZCIsImNvbnN0cnVjdG9yIiwiZGF0YSIsImNhcmRTZWxlY3RvciIsImhhbmRsZUNhcmRDbGljayIsImhhbmRsZURlbGV0ZUJ1dHRvbiIsInVzZXJJZCIsInRoaXMiLCJfZWxlbWVudCIsImRvY3VtZW50IiwicXVlcnlTZWxlY3RvciIsIl9jYXJkU2VsZWN0b3IiLCJjb250ZW50IiwiY2xvbmVOb2RlIiwicmVtb3ZlIiwiX2xpa2VCdXR0b24iLCJjbGFzc0xpc3QiLCJ0b2dnbGUiLCJfZWxlbWVudEJpbiIsImFkZEV2ZW50TGlzdGVuZXIiLCJfaGFuZGxlRGVsZXRlQnV0dG9uIiwiX2lkIiwiX2hhbmRsZUxpa2VCdXR0b24iLCJfZWxlbWVudFBpY3R1cmUiLCJfaGFuZGxlQ2FyZENsaWNrIiwiX25hbWUiLCJfbGluayIsIl9nZXRUZW1wbGF0ZSIsIl9zZXRFdmVudExpc3RlbmVycyIsInNyYyIsImFsdCIsInRleHRDb250ZW50IiwibmFtZSIsImxpbmsiLCJfb3duZXJJZCIsIm93bmVyIiwiX3VzZXJJZCIsImNvbnNvbGUiLCJsb2ciLCJoaWRlRWxlbWVudEJpbiIsInN0eWxlIiwiZGlzcGxheSIsIlBvcHVwIiwicG9wdXBTZWxlY3RvciIsIl9wb3B1cCIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJfaGFuZGxlRXNjYXBlQ2xvc2UiLCJlIiwia2V5IiwiY2xvc2UiLCJvcGVuIiwiYWRkIiwic2V0RXZlbnRMaXN0ZW5lcnMiLCJ0YXJnZXQiLCJjb250YWlucyIsIlBvcHVwV2l0aEZvcm0iLCJoYW5kbGVTdWJtaXQiLCJzdXBlciIsIl9oYW5kbGVTdWJtaXQiLCJfZm9ybSIsIl9nZXRJbnB1dFZhbHVlcyIsImlucHV0VmFsdWVzIiwicXVlcnlTZWxlY3RvckFsbCIsImZvckVhY2giLCJpbnB1dCIsInZhbHVlIiwicHJldmVudERlZmF1bHQiLCJyZXNldCIsIlNlY3Rpb24iLCJjb250YWluZXJTZWxlY3RvciIsIml0ZW1zIiwicmVuZGVyZXIiLCJfaXRlbXMiLCJfcmVuZGVyZXIiLCJfY29udGFpbmVyIiwiYWRkSXRlbSIsImVsZW1lbnQiLCJwcmVwZW5kIiwicmVuZGVyIiwiRm9ybVZhbGlkYXRvciIsInNldHRpbmdzIiwiZm9ybUVsZW1lbnQiLCJpbnB1dEVsZW1lbnQiLCJfZXJyb3JFbGVtZW50IiwiX2Zvcm1FbGVtZW50IiwiaWQiLCJfaW5wdXRFcnJvckNsYXNzIiwidmFsaWRhdGlvbk1lc3NhZ2UiLCJfZXJyb3JDbGFzcyIsInZhbGlkaXR5IiwidmFsaWQiLCJfaGlkZUlucHV0RXJyb3IiLCJfc2hvd0lucHV0RXJyb3IiLCJpbnB1dHNMaXN0IiwiQXJyYXkiLCJmcm9tIiwic29tZSIsIl9oYXNJbnZhbGlkSW5wdXQiLCJfaW5wdXRzTGlzdCIsIl9lbGVtZW50QnV0dG9uIiwiX2luYWN0aXZlQnV0dG9uQ2xhc3MiLCJzZXRBdHRyaWJ1dGUiLCJyZW1vdmVBdHRyaWJ1dGUiLCJfaW5wdXRTZWxlY3RvciIsIl90b2dnbGVCdXR0b25TdGF0ZSIsIl9jaGVja0lucHV0VmFsaWRpdHkiLCJldnQiLCJpbnB1dFNlbGVjdG9yIiwiX3N1Ym1pdEJ1dHRvblNlbGVjdG9yIiwic3VibWl0QnV0dG9uU2VsZWN0b3IiLCJpbmFjdGl2ZUJ1dHRvbkNsYXNzIiwiaW5wdXRFcnJvckNsYXNzIiwiZXJyb3JDbGFzcyIsInBhZ2VTZXR0aW5ncyIsImZvcm1TZWxlY3RvciIsImN1c3RvbUZldGNoIiwidXJsIiwiaGVhZGVycyIsImZldGNoIiwidGhlbiIsInJlcyIsIm9rIiwianNvbiIsIlByb21pc2UiLCJyZWplY3QiLCJzdGF0dXNUZXh0IiwiY2F0Y2giLCJhcGkiLCJiYXNlVXJsIiwiX2Jhc2VVcmwiLCJfaGVhZGVycyIsImdldEluaXRpYWxDYXJkcyIsImdldFVzZXJJbmZvIiwiY3JlYXRlQ2FyZCIsIm1ldGhvZCIsImJvZHkiLCJKU09OIiwic3RyaW5naWZ5IiwiZGVsZXRlQ2FyZCIsImNhcmRJZCIsImF1dGhvcml6YXRpb24iLCJwbHVzUHJvZmlsZUJ1dHRvbiIsInByb2ZpbGVGb3JtIiwiZWRpdFByb2ZpbGVCdXR0b24iLCJjYXJkRm9ybSIsImVsZW1lbnRMaXN0IiwicHJvZmlsZUlucHV0TmFtZSIsInByb2ZpbGVJbnB1dEFib3V0IiwiZ2V0RWxlbWVudEJ5SWQiLCJoZWFkZXJTcmMiLCJwcm9maWxlU3JjIiwiY2FyZEZvcm1WYWxpZGF0b3IiLCJlbmFibGVWYWxpZGF0aW9uIiwicHJvZmlsZUZvcm1WYWxpZGF0b3IiLCJjb25maXJtTW9kYWwiLCJzZXRBY3Rpb24iLCJhY3Rpb24iLCJfc3VibWl0SGFuZGxlciIsImltYWdlTW9kYWwiLCJpbWFnZSIsImVkaXRNb2RhbCIsInVzZXJJbmZvIiwic2V0VXNlckluZm8iLCJhZGRDYXJkTW9kYWwiLCJkZXNjcmlwdGlvbiIsInJlbmRlckNhcmQiLCJjYXJkIiwicmVtb3ZlQ2FyZCIsImNhcmRFbGVtZW50IiwiZ2VuZXJhdGVDYXJkIiwiY3JlYXRlTmV3Q2FyZCIsImFib3V0IiwicHJvZmlsZU5hbWVTZWxlY3RvciIsInByb2ZpbGVKb2JTZWxlY3RvciIsIl9wcm9maWxlTmFtZSIsIl9wcm9maWxlSm9iIiwiam9iIiwicmVzZXRWYWxpZGF0aW9uIiwidXNlckRhdGEiLCJmaWxsUHJvZmlsZUZvcm0iXSwic291cmNlUm9vdCI6IiJ9