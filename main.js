!function(){"use strict";var e={730:function(e,t,s){e.exports=s.p+"2f8a4cd99a9a7a10b10b.png"},14:function(e,t,s){e.exports=s.p+"4e8e0a1d604782a0dff8.svg"}},t={};function s(n){var r=t[n];if(void 0!==r)return r.exports;var i=t[n]={exports:{}};return e[n](i,i.exports,s),i.exports}s.p="",function(){function e(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class t{constructor(t,s,n,r,i,o){e(this,"_getTemplate",(()=>(this._element=document.querySelector(this._cardSelector).content.querySelector(".element").cloneNode(!0),this._element))),e(this,"removeCard",(()=>{this._element.remove(),this._element=null})),e(this,"_setEventListeners",(()=>{this._elementBin=this._element.querySelector(".element__bin"),this._elementBin.addEventListener("click",(()=>{this._handleDeleteButton(this._id)})),this._likeButton=this._element.querySelector(".element__button"),this._likeButton.addEventListener("click",(()=>{this._handleLikeButton(this._id)})),this._elementPicture.addEventListener("click",(()=>{this._handleCardClick(this._name,this._link)}))})),e(this,"generateCard",(()=>(this._element=this._getTemplate(),this._likeButton=this._element.querySelector(".element__button"),this._elementPicture=this._element.querySelector(".element__picture"),this._setEventListeners(),this._elementPicture.src=this._link,this._elementPicture.alt="Photo of ".concat(this._name),this._element.querySelector(".element__header").textContent=this._name,this._ownerId!==this._userId&&(this._elementBin=this._element.querySelector(".element__bin").style.display="none"),this._element.querySelector(".element__button-counter").textContent=this._likes.length,this._likes.some((e=>e._id===this._userId))&&this.likeCard(this._likes),this._element))),this._name=t.name,this._link=t.link,this._cardSelector=s,this._handleCardClick=n,this._handleDeleteButton=r,this._handleLikeButton=i,this._id=t._id,this._ownerId=t.owner._id,this._userId=o,this._likes=t.likes}likeCard(e){this._likes=e,this._element.querySelector(".element__button-counter").textContent=this._likes.length,this._element.querySelector(".element__button").classList.add("element__button_active")}}function n(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class r{constructor(e){n(this,"close",(()=>{this._popup.classList.remove("popup_open"),document.removeEventListener("keydown",this._handleEscapeClose)})),n(this,"_handleEscapeClose",(e=>{"Escape"===e.key&&this.close()})),this._popup=document.querySelector(e)}open(){this._popup.classList.add("popup_open"),document.addEventListener("keydown",this._handleEscapeClose)}setEventListeners(){this._popup.addEventListener("mousedown",(e=>{(e.target.classList.contains("popup_open")||e.target.classList.contains("popup__close"))&&this.close()}))}}class i extends r{constructor(e,t){super(e),this._handleSubmit=t,this._form=this._popup.querySelector(".popup__form")}_getInputValues(){const e={};return[...this._form.querySelectorAll(".popup__input")].forEach((t=>{e[t.name]=t.value})),e}setEventListeners(){this._form.addEventListener("submit",(e=>{e.preventDefault(),this._handleSubmit(this._getInputValues()),this.close()})),super.setEventListeners()}close(){this._form.reset(),super.close()}}class o{constructor(e,t){let{items:s,renderer:n}=e;this._items=s,this._renderer=n,this._container=document.querySelector(t)}addItem(e){this._container.prepend(e)}render(){this._items.forEach((e=>{this._renderer(e)}))}}function l(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class a{constructor(e,t){l(this,"_showInputError",(e=>{this._errorElement=this._formElement.querySelector(".".concat(e.id,"-error")),e.classList.add(this._inputErrorClass),this._errorElement.textContent=e.validationMessage,this._errorElement.classList.add(this._errorClass)})),l(this,"_hideInputError",(e=>{this._errorElement=this._formElement.querySelector(".".concat(e.id,"-error")),e.classList.remove(this._inputErrorClass),this._errorElement.classList.remove(this._errorClass),this._errorElement.textContent=""})),l(this,"_checkInputValidity",(e=>{e.validity.valid?this._hideInputError(e):this._showInputError(e)})),l(this,"_hasInvalidInput",(e=>Array.from(e).some((e=>!e.validity.valid)))),l(this,"_toggleButtonState",(()=>{this._hasInvalidInput(this._inputsList)?(this._elementButton.classList.add(this._inactiveButtonClass),this._elementButton.setAttribute("disabled",!0)):(this._elementButton.classList.remove(this._inactiveButtonClass),this._elementButton.removeAttribute("disabled"))})),l(this,"_setEventListeners",(()=>{this._inputsList=Array.from(this._formElement.querySelectorAll(this._inputSelector)),this._toggleButtonState(),this._inputsList.forEach((e=>{e.addEventListener("input",(()=>{this._checkInputValidity(e),this._toggleButtonState()}))}))})),l(this,"enableValidation",(()=>{this._formElement.addEventListener("submit",(e=>{e.preventDefault()})),this._setEventListeners()})),l(this,"resetValidation",(()=>{this._inputsList.forEach((e=>{this._hideInputError(e)})),this._toggleButtonState()})),this._inputSelector=e.inputSelector,this._submitButtonSelector=e.submitButtonSelector,this._inactiveButtonClass=e.inactiveButtonClass,this._inputErrorClass=e.inputErrorClass,this._errorClass=e.errorClass,this._formElement=t,this._elementButton=this._formElement.querySelector(this._submitButtonSelector)}}const _={formSelector:".popup__form",inputSelector:".popup__input",submitButtonSelector:".popup__button",inactiveButtonClass:"popup__button_disabled",inputErrorClass:"popup__input_type_error",errorClass:"popup__error_visible"},u=(e,t)=>fetch(e,t).then((e=>e.ok?e.json():Promise.reject(e.statusText))).catch(console.log),c=new class{constructor(e){let{baseUrl:t,headers:s}=e;this._baseUrl=t,this._headers=s}getInitialCards(){return u("".concat(this._baseUrl,"/cards"),{headers:this._headers})}getUserInfo(){return u("".concat(this._baseUrl,"/users/me"),{headers:this._headers})}createCard(e){let{name:t,link:s}=e;return u("".concat(this._baseUrl,"/cards"),{method:"POST",headers:this._headers,body:JSON.stringify({name:t,link:s})})}deleteCard(e){return u("".concat(this._baseUrl,"/cards/").concat(e),{method:"DELETE",headers:this._headers})}likeCard(e){return u("".concat(this._baseUrl,"/cards/likes/").concat(e),{method:"PUT",headers:this._headers})}}({baseUrl:"https://around.nomoreparties.co/v1/group-12",headers:{authorization:"32b9efa0-6f35-4afe-975e-e3a6be43cfcb","Content-Type":"application/json"}});var h=s(14),p=s(730);const d=document.querySelector(".profile__plus"),m=document.querySelector(".popup__form"),f=document.querySelector(".profile__edit"),b=document.querySelector(".popup__form_second"),v=document.querySelector(".elements__list"),E=document.querySelector(".popup__input-name"),S=document.querySelector(".popup__input-about");let y;document.getElementById("around-the-us").src=h,document.getElementById("profile-image").src=p;const C=new a(_,b);C.enableValidation();const g=new a(_,m);g.enableValidation();const L=new class extends r{setAction(e){this._submitHandler=e,this._form=this._popup.querySelector(".popup__form")}_getInputValues(){const e={};return[...this._form.querySelectorAll(".popup__input")].forEach((t=>{e[t.name]=t.value})),e}setEventListeners(){this._popup.addEventListener("submit",(e=>{e.preventDefault(),this._submitHandler(this._getInputValues()),this.close()})),super.setEventListeners()}}(".popup_card_remover");L.setEventListeners();const k=new class extends r{open(e,t){const s=this._popup.querySelector(".popup__image");this._popup.querySelector(".popup__description").textContent=e,s.alt="Photo of ".concat(e),s.src=t,super.open()}}(".popup_big_image");k.setEventListeners();const q=new i(".popup_profile_adder",(e=>{w.setUserInfo(e)}));q.setEventListeners();const I=new i(".popup_card_publisher",(e=>{c.createCard({name:e.description,link:e.link}).then((e=>{B(e)}))}));I.setEventListeners();const B=e=>{const s=function(e){const s=new t(e,"#card-template",((e,t)=>k.open(e,t)),(e=>{L.open(),L.setAction((()=>{c.deleteCard(e).then((e=>{console.log("This card was deleted",e),s.removeCard()}))}))}),(e=>{c.likeCard(e).then((e=>{s.likeCard(e.likes),console.log("res",e)}))}),y);return s.generateCard()}(e);v.prepend(s)};c.getUserInfo().then((e=>{y=e._id,w.setUserInfo({name:e.name,about:e.about})})),c.getInitialCards().then((e=>{console.log("res",e),new o({items:e,renderer:B},".elements__list").render()}));const w=new class{constructor(e){let{profileNameSelector:t,profileJobSelector:s}=e;this._profileName=document.querySelector(t),this._profileJob=document.querySelector(s)}getUserInfo(){return{name:this._profileName.textContent,job:this._profileJob.textContent}}setUserInfo(e){let{name:t,about:s}=e;this._profileName.textContent=t,this._profileJob.textContent=s}}({profileNameSelector:".profile__author",profileJobSelector:".profile__text"});f.addEventListener("click",(()=>{g.resetValidation(m),function(){const e=w.getUserInfo();E.value=e.name,S.value=e.job}(),q.open()})),d.addEventListener("click",(()=>{C.resetValidation(b),I.open()}))}()}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QzJJLEVBQWtCeUIsZ0JBQWdCaEMsR0FDbENtQixFQUFhakgsVSIsInNvdXJjZXMiOlsid2VicGFjazovL3dlYl9wcm9qZWN0XzQvd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC93ZWJwYWNrL3J1bnRpbWUvcHVibGljUGF0aCIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL3NjcmlwdHMvY29tcG9uZW50cy9DYXJkLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvc2NyaXB0cy9jb21wb25lbnRzL1BvcHVwLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvc2NyaXB0cy9jb21wb25lbnRzL1BvcHVwV2l0aEZvcm0uanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9zY3JpcHRzL2NvbXBvbmVudHMvU2VjdGlvbi5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL3NjcmlwdHMvY29tcG9uZW50cy9Gcm9tVmFsaWRhdG9yLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvc2NyaXB0cy91dGlscy9jb25zdGFudHMuanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9zY3JpcHRzL2NvbXBvbmVudHMvQXBpLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvcGFnZXMvaW5kZXguanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9zY3JpcHRzL2NvbXBvbmVudHMvUG9wdXBXaXRoU3VibWl0LmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvc2NyaXB0cy9jb21wb25lbnRzL1BvcHVwV2l0aEltYWdlLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvc2NyaXB0cy9jb21wb25lbnRzL1VzZXJJbmZvLmpzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIFRoZSBtb2R1bGUgY2FjaGVcbnZhciBfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX18gPSB7fTtcblxuLy8gVGhlIHJlcXVpcmUgZnVuY3Rpb25cbmZ1bmN0aW9uIF9fd2VicGFja19yZXF1aXJlX18obW9kdWxlSWQpIHtcblx0Ly8gQ2hlY2sgaWYgbW9kdWxlIGlzIGluIGNhY2hlXG5cdHZhciBjYWNoZWRNb2R1bGUgPSBfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX19bbW9kdWxlSWRdO1xuXHRpZiAoY2FjaGVkTW9kdWxlICE9PSB1bmRlZmluZWQpIHtcblx0XHRyZXR1cm4gY2FjaGVkTW9kdWxlLmV4cG9ydHM7XG5cdH1cblx0Ly8gQ3JlYXRlIGEgbmV3IG1vZHVsZSAoYW5kIHB1dCBpdCBpbnRvIHRoZSBjYWNoZSlcblx0dmFyIG1vZHVsZSA9IF9fd2VicGFja19tb2R1bGVfY2FjaGVfX1ttb2R1bGVJZF0gPSB7XG5cdFx0Ly8gbm8gbW9kdWxlLmlkIG5lZWRlZFxuXHRcdC8vIG5vIG1vZHVsZS5sb2FkZWQgbmVlZGVkXG5cdFx0ZXhwb3J0czoge31cblx0fTtcblxuXHQvLyBFeGVjdXRlIHRoZSBtb2R1bGUgZnVuY3Rpb25cblx0X193ZWJwYWNrX21vZHVsZXNfX1ttb2R1bGVJZF0obW9kdWxlLCBtb2R1bGUuZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyk7XG5cblx0Ly8gUmV0dXJuIHRoZSBleHBvcnRzIG9mIHRoZSBtb2R1bGVcblx0cmV0dXJuIG1vZHVsZS5leHBvcnRzO1xufVxuXG4iLCJfX3dlYnBhY2tfcmVxdWlyZV9fLnAgPSBcIlwiOyIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIENhcmQge1xuICBjb25zdHJ1Y3RvcihkYXRhLCBjYXJkU2VsZWN0b3IsIGhhbmRsZUNhcmRDbGljaywgaGFuZGxlRGVsZXRlQnV0dG9uLCBoYW5kbGVMaWtlQnV0dG9uLCB1c2VySWQpIHtcbiAgICB0aGlzLl9uYW1lID0gZGF0YS5uYW1lO1xuICAgIHRoaXMuX2xpbmsgPSBkYXRhLmxpbms7XG4gICAgdGhpcy5fY2FyZFNlbGVjdG9yID0gY2FyZFNlbGVjdG9yO1xuICAgIHRoaXMuX2hhbmRsZUNhcmRDbGljayA9IGhhbmRsZUNhcmRDbGljaztcbiAgICB0aGlzLl9oYW5kbGVEZWxldGVCdXR0b24gPSBoYW5kbGVEZWxldGVCdXR0b247XG4gICAgdGhpcy5faGFuZGxlTGlrZUJ1dHRvbiA9IGhhbmRsZUxpa2VCdXR0b247XG4gICAgdGhpcy5faWQgPSBkYXRhLl9pZDtcbiAgICB0aGlzLl9vd25lcklkID0gZGF0YS5vd25lci5faWQ7XG4gICAgdGhpcy5fdXNlcklkID0gdXNlcklkO1xuICAgIHRoaXMuX2xpa2VzID0gZGF0YS5saWtlcztcbiAgfVxuXG4gIF9nZXRUZW1wbGF0ZSA9ICgpID0+IHtcbiAgICB0aGlzLl9lbGVtZW50ID0gZG9jdW1lbnRcbiAgICAgIC5xdWVyeVNlbGVjdG9yKHRoaXMuX2NhcmRTZWxlY3RvcilcbiAgICAgIC5jb250ZW50LnF1ZXJ5U2VsZWN0b3IoXCIuZWxlbWVudFwiKVxuICAgICAgLmNsb25lTm9kZSh0cnVlKTtcbiAgICByZXR1cm4gdGhpcy5fZWxlbWVudDtcbiAgfTtcblxuICByZW1vdmVDYXJkID0gKCkgPT4ge1xuICAgIGNvbnN0IGNhcmQgPSB0aGlzLl9lbGVtZW50O1xuICAgIGNhcmQucmVtb3ZlKCk7XG4gICAgdGhpcy5fZWxlbWVudCA9IG51bGw7XG4gIH07XG5cbiBsaWtlQ2FyZChuZXdMaWtlcykge1xuICAgdGhpcy5fbGlrZXMgPSBuZXdMaWtlc1xuICAgdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmVsZW1lbnRfX2J1dHRvbi1jb3VudGVyXCIpLnRleHRDb250ZW50ID0gdGhpcy5fbGlrZXMubGVuZ3RoXG4gIHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5lbGVtZW50X19idXR0b25cIikuY2xhc3NMaXN0LmFkZChcImVsZW1lbnRfX2J1dHRvbl9hY3RpdmVcIik7XG4gIH07XG5cbiAgX3NldEV2ZW50TGlzdGVuZXJzID0gKCkgPT4ge1xuICAgIHRoaXMuX2VsZW1lbnRCaW4gPSB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuZWxlbWVudF9fYmluXCIpO1xuICAgIHRoaXMuX2VsZW1lbnRCaW4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgICAgIHRoaXMuX2hhbmRsZURlbGV0ZUJ1dHRvbih0aGlzLl9pZCk7XG4gICAgfSk7XG4gICAgdGhpcy5fbGlrZUJ1dHRvbiA9IHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5lbGVtZW50X19idXR0b25cIik7XG4gICAgdGhpcy5fbGlrZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4geyB0aGlzLl9oYW5kbGVMaWtlQnV0dG9uKHRoaXMuX2lkKVxuICAgIH0pO1xuICAgIHRoaXMuX2VsZW1lbnRQaWN0dXJlLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gICAgICB0aGlzLl9oYW5kbGVDYXJkQ2xpY2sodGhpcy5fbmFtZSwgdGhpcy5fbGluayk7XG4gICAgfSk7XG4gIH07XG5cbiAgZ2VuZXJhdGVDYXJkID0gKCkgPT4ge1xuICAgIHRoaXMuX2VsZW1lbnQgPSB0aGlzLl9nZXRUZW1wbGF0ZSgpO1xuICAgIHRoaXMuX2xpa2VCdXR0b24gPSB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuZWxlbWVudF9fYnV0dG9uXCIpO1xuICAgIHRoaXMuX2VsZW1lbnRQaWN0dXJlID0gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmVsZW1lbnRfX3BpY3R1cmVcIik7XG4gICAgdGhpcy5fc2V0RXZlbnRMaXN0ZW5lcnMoKTtcbiAgICB0aGlzLl9lbGVtZW50UGljdHVyZS5zcmMgPSB0aGlzLl9saW5rO1xuICAgIHRoaXMuX2VsZW1lbnRQaWN0dXJlLmFsdCA9IGBQaG90byBvZiAke3RoaXMuX25hbWV9YDtcbiAgICB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuZWxlbWVudF9faGVhZGVyXCIpLnRleHRDb250ZW50ID0gdGhpcy5fbmFtZTtcbiAgICBpZiAodGhpcy5fb3duZXJJZCAhPT0gdGhpcy5fdXNlcklkKSB7XG4gICAgICB0aGlzLl9lbGVtZW50QmluID0gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmVsZW1lbnRfX2JpblwiKS5zdHlsZS5kaXNwbGF5ID0gXCJub25lXCJ9OyAgICBcbiAgICAgIHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5lbGVtZW50X19idXR0b24tY291bnRlclwiKS50ZXh0Q29udGVudCA9IHRoaXMuX2xpa2VzLmxlbmd0aDtcbiAgICAgY29uc3QgaXNMaWtlZCA9IHRoaXMuX2xpa2VzLnNvbWUoKHBlcnNvbikgPT4gcGVyc29uLl9pZCA9PT0gdGhpcy5fdXNlcklkKVxuICAgICBpZihpc0xpa2VkKSB7XG4gICAgICB0aGlzLmxpa2VDYXJkKHRoaXMuX2xpa2VzKTtcbiAgICAgfVxuXG4gICAgcmV0dXJuIHRoaXMuX2VsZW1lbnQ7XG4gIH07XG59XG5cbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwIHtcbiAgY29uc3RydWN0b3IocG9wdXBTZWxlY3Rvcikge1xuICAgIHRoaXMuX3BvcHVwID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihwb3B1cFNlbGVjdG9yKTtcbiAgfVxuICBvcGVuKCkge1xuICAgIHRoaXMuX3BvcHVwLmNsYXNzTGlzdC5hZGQoXCJwb3B1cF9vcGVuXCIpO1xuICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIHRoaXMuX2hhbmRsZUVzY2FwZUNsb3NlKTtcbiAgfVxuXG4gIGNsb3NlID0gKCkgPT4ge1xuICAgIHRoaXMuX3BvcHVwLmNsYXNzTGlzdC5yZW1vdmUoXCJwb3B1cF9vcGVuXCIpO1xuICAgIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIHRoaXMuX2hhbmRsZUVzY2FwZUNsb3NlKTtcbiAgfTtcblxuICBzZXRFdmVudExpc3RlbmVycygpIHtcbiAgICB0aGlzLl9wb3B1cC5hZGRFdmVudExpc3RlbmVyKFwibW91c2Vkb3duXCIsIChlKSA9PiB7XG4gICAgICBpZiAoXG4gICAgICAgIGUudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucyhcInBvcHVwX29wZW5cIikgfHxcbiAgICAgICAgZS50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKFwicG9wdXBfX2Nsb3NlXCIpXG4gICAgICApIHtcbiAgICAgICAgdGhpcy5jbG9zZSgpO1xuICAgICAgfVxuICAgIH0pO1xuICB9XG5cbiAgX2hhbmRsZUVzY2FwZUNsb3NlID0gKGUpID0+IHtcbiAgICBpZiAoZS5rZXkgPT09IFwiRXNjYXBlXCIpIHtcbiAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICB9XG4gIH07XG59XG4iLCJpbXBvcnQgUG9wdXAgZnJvbSBcIi4vUG9wdXBcIjtcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwV2l0aEZvcm0gZXh0ZW5kcyBQb3B1cCB7XG4gIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IsIGhhbmRsZVN1Ym1pdCkge1xuICAgIHN1cGVyKHBvcHVwU2VsZWN0b3IpO1xuICAgIHRoaXMuX2hhbmRsZVN1Ym1pdCA9IGhhbmRsZVN1Ym1pdDtcbiAgICB0aGlzLl9mb3JtID0gdGhpcy5fcG9wdXAucXVlcnlTZWxlY3RvcihcIi5wb3B1cF9fZm9ybVwiKTtcbiAgfVxuICBfZ2V0SW5wdXRWYWx1ZXMoKSB7XG4gICAgY29uc3QgaW5wdXRWYWx1ZXMgPSB7fTtcbiAgICBjb25zdCBpbnB1dHMgPSBbLi4udGhpcy5fZm9ybS5xdWVyeVNlbGVjdG9yQWxsKFwiLnBvcHVwX19pbnB1dFwiKV07XG4gICAgaW5wdXRzLmZvckVhY2goKGlucHV0KSA9PiB7XG4gICAgICBpbnB1dFZhbHVlc1tpbnB1dC5uYW1lXSA9IGlucHV0LnZhbHVlO1xuICAgIH0pO1xuICAgIHJldHVybiBpbnB1dFZhbHVlcztcbiAgfVxuXG4gIHNldEV2ZW50TGlzdGVuZXJzKCkge1xuICAgIHRoaXMuX2Zvcm0uYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCAoZSkgPT4ge1xuICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgdGhpcy5faGFuZGxlU3VibWl0KHRoaXMuX2dldElucHV0VmFsdWVzKCkpO1xuICAgICAgdGhpcy5jbG9zZSgpO1xuICAgIH0pO1xuICAgIHN1cGVyLnNldEV2ZW50TGlzdGVuZXJzKCk7XG4gIH1cblxuICBjbG9zZSgpIHtcbiAgICB0aGlzLl9mb3JtLnJlc2V0KCk7XG4gICAgc3VwZXIuY2xvc2UoKTtcbiAgfVxufVxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgU2VjdGlvbiB7XG4gIGNvbnN0cnVjdG9yKHsgaXRlbXMsIHJlbmRlcmVyIH0sIGNvbnRhaW5lclNlbGVjdG9yKSB7XG4gICAgdGhpcy5faXRlbXMgPSBpdGVtcztcbiAgICB0aGlzLl9yZW5kZXJlciA9IHJlbmRlcmVyO1xuICAgIHRoaXMuX2NvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoY29udGFpbmVyU2VsZWN0b3IpO1xuICB9XG5cbiAgYWRkSXRlbShlbGVtZW50KSB7XG4gICAgdGhpcy5fY29udGFpbmVyLnByZXBlbmQoZWxlbWVudCk7XG4gIH1cblxuICByZW5kZXIoKSB7XG4gICAgdGhpcy5faXRlbXMuZm9yRWFjaCgoZGF0YSkgPT4ge1xuICAgICAgdGhpcy5fcmVuZGVyZXIoZGF0YSk7XG4gICAgfSk7XG4gIH1cbn1cbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIEZvcm1WYWxpZGF0b3Ige1xuICBjb25zdHJ1Y3RvcihzZXR0aW5ncywgZm9ybUVsZW1lbnQpIHtcbiAgICB0aGlzLl9pbnB1dFNlbGVjdG9yID0gc2V0dGluZ3MuaW5wdXRTZWxlY3RvcjtcbiAgICB0aGlzLl9zdWJtaXRCdXR0b25TZWxlY3RvciA9IHNldHRpbmdzLnN1Ym1pdEJ1dHRvblNlbGVjdG9yO1xuICAgIHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MgPSBzZXR0aW5ncy5pbmFjdGl2ZUJ1dHRvbkNsYXNzO1xuICAgIHRoaXMuX2lucHV0RXJyb3JDbGFzcyA9IHNldHRpbmdzLmlucHV0RXJyb3JDbGFzcztcbiAgICB0aGlzLl9lcnJvckNsYXNzID0gc2V0dGluZ3MuZXJyb3JDbGFzcztcbiAgICB0aGlzLl9mb3JtRWxlbWVudCA9IGZvcm1FbGVtZW50O1xuICAgIHRoaXMuX2VsZW1lbnRCdXR0b24gPSB0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKFxuICAgICAgdGhpcy5fc3VibWl0QnV0dG9uU2VsZWN0b3JcbiAgICApO1xuICB9XG5cbiAgX3Nob3dJbnB1dEVycm9yID0gKGlucHV0RWxlbWVudCkgPT4ge1xuICAgIHRoaXMuX2Vycm9yRWxlbWVudCA9IHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXG4gICAgICBgLiR7aW5wdXRFbGVtZW50LmlkfS1lcnJvcmBcbiAgICApO1xuICAgIGlucHV0RWxlbWVudC5jbGFzc0xpc3QuYWRkKHRoaXMuX2lucHV0RXJyb3JDbGFzcyk7XG4gICAgdGhpcy5fZXJyb3JFbGVtZW50LnRleHRDb250ZW50ID0gaW5wdXRFbGVtZW50LnZhbGlkYXRpb25NZXNzYWdlO1xuICAgIHRoaXMuX2Vycm9yRWxlbWVudC5jbGFzc0xpc3QuYWRkKHRoaXMuX2Vycm9yQ2xhc3MpO1xuICB9O1xuXG4gIF9oaWRlSW5wdXRFcnJvciA9IChpbnB1dEVsZW1lbnQpID0+IHtcbiAgICB0aGlzLl9lcnJvckVsZW1lbnQgPSB0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKFxuICAgICAgYC4ke2lucHV0RWxlbWVudC5pZH0tZXJyb3JgXG4gICAgKTtcbiAgICBpbnB1dEVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9pbnB1dEVycm9yQ2xhc3MpO1xuICAgIHRoaXMuX2Vycm9yRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2Vycm9yQ2xhc3MpO1xuICAgIHRoaXMuX2Vycm9yRWxlbWVudC50ZXh0Q29udGVudCA9IFwiXCI7XG4gIH07XG5cbiAgX2NoZWNrSW5wdXRWYWxpZGl0eSA9IChpbnB1dEVsZW1lbnQpID0+IHtcbiAgICBpZiAoIWlucHV0RWxlbWVudC52YWxpZGl0eS52YWxpZCkge1xuICAgICAgdGhpcy5fc2hvd0lucHV0RXJyb3IoaW5wdXRFbGVtZW50KTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5faGlkZUlucHV0RXJyb3IoaW5wdXRFbGVtZW50KTtcbiAgICB9XG4gIH07XG5cbiAgX2hhc0ludmFsaWRJbnB1dCA9IChpbnB1dHNMaXN0KSA9PiB7XG4gICAgY29uc3QgaW5wdXRzID0gQXJyYXkuZnJvbShpbnB1dHNMaXN0KTtcbiAgICByZXR1cm4gaW5wdXRzLnNvbWUoKGlucHV0RWxlbWVudCkgPT4ge1xuICAgICAgcmV0dXJuICFpbnB1dEVsZW1lbnQudmFsaWRpdHkudmFsaWQ7XG4gICAgfSk7XG4gIH07XG5cbiAgX3RvZ2dsZUJ1dHRvblN0YXRlID0gKCkgPT4ge1xuICAgIGlmICh0aGlzLl9oYXNJbnZhbGlkSW5wdXQodGhpcy5faW5wdXRzTGlzdCkpIHtcbiAgICAgIHRoaXMuX2VsZW1lbnRCdXR0b24uY2xhc3NMaXN0LmFkZCh0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcbiAgICAgIHRoaXMuX2VsZW1lbnRCdXR0b24uc2V0QXR0cmlidXRlKFwiZGlzYWJsZWRcIiwgdHJ1ZSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuX2VsZW1lbnRCdXR0b24uY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcbiAgICAgIHRoaXMuX2VsZW1lbnRCdXR0b24ucmVtb3ZlQXR0cmlidXRlKFwiZGlzYWJsZWRcIik7XG4gICAgfVxuICB9O1xuXG4gIF9zZXRFdmVudExpc3RlbmVycyA9ICgpID0+IHtcbiAgICB0aGlzLl9pbnB1dHNMaXN0ID0gQXJyYXkuZnJvbShcbiAgICAgIHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwodGhpcy5faW5wdXRTZWxlY3RvcilcbiAgICApO1xuICAgIHRoaXMuX3RvZ2dsZUJ1dHRvblN0YXRlKCk7XG4gICAgdGhpcy5faW5wdXRzTGlzdC5mb3JFYWNoKChpbnB1dEVsZW1lbnQpID0+IHtcbiAgICAgIGlucHV0RWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwiaW5wdXRcIiwgKCkgPT4ge1xuICAgICAgICB0aGlzLl9jaGVja0lucHV0VmFsaWRpdHkoaW5wdXRFbGVtZW50KTtcbiAgICAgICAgdGhpcy5fdG9nZ2xlQnV0dG9uU3RhdGUoKTtcbiAgICAgIH0pO1xuICAgIH0pO1xuICB9O1xuXG4gIGVuYWJsZVZhbGlkYXRpb24gPSAoKSA9PiB7XG4gICAgdGhpcy5fZm9ybUVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCAoZXZ0KSA9PiB7XG4gICAgICBldnQucHJldmVudERlZmF1bHQoKTtcbiAgICB9KTtcbiAgICB0aGlzLl9zZXRFdmVudExpc3RlbmVycygpO1xuICB9O1xuXG4gIHJlc2V0VmFsaWRhdGlvbiA9ICgpID0+IHtcbiAgICB0aGlzLl9pbnB1dHNMaXN0LmZvckVhY2goKGlucHV0RWxlbWVudCkgPT4ge1xuICAgICAgdGhpcy5faGlkZUlucHV0RXJyb3IoaW5wdXRFbGVtZW50KTtcbiAgICB9KTtcbiAgICB0aGlzLl90b2dnbGVCdXR0b25TdGF0ZSgpO1xuICB9O1xufVxuIiwiZXhwb3J0IHsgcGFnZVNldHRpbmdzIH07XG5cbi8qY29uc3QgaW5pdGlhbENhcmRzID0gW1xuICB7XG4gICAgbmFtZTogXCJZb3NlbWl0ZSBWYWxsZXlcIixcbiAgICBsaW5rOiBcImh0dHBzOi8vY29kZS5zMy55YW5kZXgubmV0L3dlYi1jb2RlL3lvc2VtaXRlLmpwZ1wiLFxuICB9LFxuICB7XG4gICAgbmFtZTogXCJMYWtlIExvdWlzZVwiLFxuICAgIGxpbms6IFwiaHR0cHM6Ly9jb2RlLnMzLnlhbmRleC5uZXQvd2ViLWNvZGUvbGFrZS1sb3Vpc2UuanBnXCIsXG4gIH0sXG4gIHtcbiAgICBuYW1lOiBcIkJhbGQgTW91bnRhaW5zXCIsXG4gICAgbGluazogXCJodHRwczovL2NvZGUuczMueWFuZGV4Lm5ldC93ZWItY29kZS9iYWxkLW1vdW50YWlucy5qcGdcIixcbiAgfSxcbiAge1xuICAgIG5hbWU6IFwiTGF0ZW1hclwiLFxuICAgIGxpbms6IFwiaHR0cHM6Ly9jb2RlLnMzLnlhbmRleC5uZXQvd2ViLWNvZGUvbGF0ZW1hci5qcGdcIixcbiAgfSxcbiAge1xuICAgIG5hbWU6IFwiVmFub2lzZSBOYXRpb25hbCBQYXJrXCIsXG4gICAgbGluazogXCJodHRwczovL2NvZGUuczMueWFuZGV4Lm5ldC93ZWItY29kZS92YW5vaXNlLmpwZ1wiLFxuICB9LFxuICB7XG4gICAgbmFtZTogXCJMYWdvIGRpIEJyYWllc1wiLFxuICAgIGxpbms6IFwiaHR0cHM6Ly9jb2RlLnMzLnlhbmRleC5uZXQvd2ViLWNvZGUvbGFnby5qcGdcIixcbiAgfSxcbl07XG4qL1xuY29uc3QgcGFnZVNldHRpbmdzID0ge1xuICBmb3JtU2VsZWN0b3I6IFwiLnBvcHVwX19mb3JtXCIsXG4gIGlucHV0U2VsZWN0b3I6IFwiLnBvcHVwX19pbnB1dFwiLFxuICBzdWJtaXRCdXR0b25TZWxlY3RvcjogXCIucG9wdXBfX2J1dHRvblwiLFxuICBpbmFjdGl2ZUJ1dHRvbkNsYXNzOiBcInBvcHVwX19idXR0b25fZGlzYWJsZWRcIixcbiAgaW5wdXRFcnJvckNsYXNzOiBcInBvcHVwX19pbnB1dF90eXBlX2Vycm9yXCIsXG4gIGVycm9yQ2xhc3M6IFwicG9wdXBfX2Vycm9yX3Zpc2libGVcIixcbn07XG5cbiIsImNvbnN0IGN1c3RvbUZldGNoID0gKHVybCwgaGVhZGVycykgPT4gXG5mZXRjaCh1cmwsIGhlYWRlcnMpXG4udGhlbihyZXMgPT4gcmVzLm9rID8gcmVzLmpzb24oKSA6IFByb21pc2UucmVqZWN0KHJlcy5zdGF0dXNUZXh0KSlcbi5jYXRjaChjb25zb2xlLmxvZylcblxuY2xhc3MgQXBpIHtcbiAgY29uc3RydWN0b3IoeyBiYXNlVXJsLCBoZWFkZXJzIH0pIHtcbiAgICB0aGlzLl9iYXNlVXJsID0gYmFzZVVybDtcbiAgICB0aGlzLl9oZWFkZXJzID0gaGVhZGVycztcbiAgfVxuXG4gIGdldEluaXRpYWxDYXJkcygpIHtcbiAgICByZXR1cm4gY3VzdG9tRmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHNgLCB7IFxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVyc1xuICAgICB9KVxuICB9XG5cbiAgZ2V0VXNlckluZm8oKSB7XG4gICAgcmV0dXJuIGN1c3RvbUZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L3VzZXJzL21lYCwgeyBcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnNcbiAgICAgfSlcbiAgfVxuXG4gIGNyZWF0ZUNhcmQoe25hbWUsIGxpbmt9KSB7XG4gICAgcmV0dXJuIGN1c3RvbUZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzYCwgeyBcbiAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgbmFtZSxcbiAgICAgICAgbGlua1xuICAgICAgfSlcbiAgICAgfSlcbiAgfVxuXG4gIGRlbGV0ZUNhcmQoY2FyZElkKSB7XG4gICAgcmV0dXJuIGN1c3RvbUZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzLyR7Y2FyZElkfWAsIHsgXG4gICAgICBtZXRob2Q6ICdERUxFVEUnLFxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcbiAgICAgfSlcbiAgfVxuXG4gIGxpa2VDYXJkKGNhcmRJZCkge1xuICAgIHJldHVybiBjdXN0b21GZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkcy9saWtlcy8ke2NhcmRJZH1gLCB7IFxuICAgICAgbWV0aG9kOiAnUFVUJyxcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgIH0pXG4gIH1cbn1cblxuZXhwb3J0IGNvbnN0IGFwaSA9IG5ldyBBcGkoe1xuICBiYXNlVXJsOiBcImh0dHBzOi8vYXJvdW5kLm5vbW9yZXBhcnRpZXMuY28vdjEvZ3JvdXAtMTJcIixcbiAgaGVhZGVyczoge1xuICAgIGF1dGhvcml6YXRpb246IFwiMzJiOWVmYTAtNmYzNS00YWZlLTk3NWUtZTNhNmJlNDNjZmNiXCIsXG4gICAgXCJDb250ZW50LVR5cGVcIjogXCJhcHBsaWNhdGlvbi9qc29uXCIsXG4gIH0sXG59KTtcbiIsImltcG9ydCBcIi4uL3BhZ2VzL2luZGV4LmNzc1wiO1xuaW1wb3J0IENhcmQgZnJvbSBcIi4uL3NjcmlwdHMvY29tcG9uZW50cy9DYXJkXCI7XG5pbXBvcnQgUG9wdXBXaXRoSW1hZ2UgZnJvbSBcIi4uL3NjcmlwdHMvY29tcG9uZW50cy9Qb3B1cFdpdGhJbWFnZVwiO1xuaW1wb3J0IFBvcHVwV2l0aEZvcm0gZnJvbSBcIi4uL3NjcmlwdHMvY29tcG9uZW50cy9Qb3B1cFdpdGhGb3JtXCI7XG5pbXBvcnQgVXNlckluZm8gZnJvbSBcIi4uL3NjcmlwdHMvY29tcG9uZW50cy9Vc2VySW5mb1wiO1xuaW1wb3J0IFNlY3Rpb24gZnJvbSBcIi4uL3NjcmlwdHMvY29tcG9uZW50cy9TZWN0aW9uXCI7XG5pbXBvcnQgRm9ybVZhbGlkYXRvciBmcm9tIFwiLi4vc2NyaXB0cy9jb21wb25lbnRzL0Zyb21WYWxpZGF0b3JcIjtcbmltcG9ydCBQb3B1cFdpdGhTdWJtaXQgZnJvbSBcIi4uL3NjcmlwdHMvY29tcG9uZW50cy9Qb3B1cFdpdGhTdWJtaXRcIjtcbmltcG9ydCB7IHBhZ2VTZXR0aW5ncyB9IGZyb20gXCIuLi9zY3JpcHRzL3V0aWxzL2NvbnN0YW50c1wiO1xuaW1wb3J0IHsgYXBpIH0gZnJvbSBcIi4uL3NjcmlwdHMvY29tcG9uZW50cy9BcGlcIjtcblxuY29uc3QgcGx1c1Byb2ZpbGVCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX3BsdXNcIik7XG5jb25zdCBwcm9maWxlRm9ybSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXBfX2Zvcm1cIik7XG5jb25zdCBlZGl0UHJvZmlsZUJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fZWRpdFwiKTtcbmNvbnN0IGNhcmRGb3JtID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wb3B1cF9fZm9ybV9zZWNvbmRcIik7XG5jb25zdCBlbGVtZW50TGlzdCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuZWxlbWVudHNfX2xpc3RcIik7XG5jb25zdCBwcm9maWxlSW5wdXROYW1lID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wb3B1cF9faW5wdXQtbmFtZVwiKTtcbmNvbnN0IHByb2ZpbGVJbnB1dEFib3V0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wb3B1cF9faW5wdXQtYWJvdXRcIik7XG5sZXQgdXNlcklkO1xuXG5pbXBvcnQgaGVhZGVyU3JjIGZyb20gXCIuLi9pbWFnZXMvaGVhZGVyLnN2Z1wiO1xuY29uc3QgaGVhZGVySW1hZ2UgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImFyb3VuZC10aGUtdXNcIik7XG5oZWFkZXJJbWFnZS5zcmMgPSBoZWFkZXJTcmM7XG5cbmltcG9ydCBwcm9maWxlU3JjIGZyb20gXCIuLi9pbWFnZXMvQ291c3RlYXUucG5nXCI7XG5jb25zdCBwcm9maWxlSW1hZ2UgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInByb2ZpbGUtaW1hZ2VcIik7XG5wcm9maWxlSW1hZ2Uuc3JjID0gcHJvZmlsZVNyYztcblxuY29uc3QgY2FyZEZvcm1WYWxpZGF0b3IgPSBuZXcgRm9ybVZhbGlkYXRvcihwYWdlU2V0dGluZ3MsIGNhcmRGb3JtKTtcbmNhcmRGb3JtVmFsaWRhdG9yLmVuYWJsZVZhbGlkYXRpb24oKTtcblxuY29uc3QgcHJvZmlsZUZvcm1WYWxpZGF0b3IgPSBuZXcgRm9ybVZhbGlkYXRvcihwYWdlU2V0dGluZ3MsIHByb2ZpbGVGb3JtKTtcbnByb2ZpbGVGb3JtVmFsaWRhdG9yLmVuYWJsZVZhbGlkYXRpb24oKTtcblxuY29uc3QgY29uZmlybU1vZGFsID0gbmV3IFBvcHVwV2l0aFN1Ym1pdChcIi5wb3B1cF9jYXJkX3JlbW92ZXJcIik7XG5jb25maXJtTW9kYWwuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcblxuY29uc3QgaW1hZ2VNb2RhbCA9IG5ldyBQb3B1cFdpdGhJbWFnZShcIi5wb3B1cF9iaWdfaW1hZ2VcIik7XG5pbWFnZU1vZGFsLnNldEV2ZW50TGlzdGVuZXJzKCk7XG5cbmNvbnN0IGVkaXRNb2RhbCA9IG5ldyBQb3B1cFdpdGhGb3JtKFwiLnBvcHVwX3Byb2ZpbGVfYWRkZXJcIiwgKGRhdGEpID0+IHtcbiAgdXNlckluZm8uc2V0VXNlckluZm8oZGF0YSk7XG59KTtcbmVkaXRNb2RhbC5zZXRFdmVudExpc3RlbmVycygpO1xuXG5jb25zdCBhZGRDYXJkTW9kYWwgPSBuZXcgUG9wdXBXaXRoRm9ybShcIi5wb3B1cF9jYXJkX3B1Ymxpc2hlclwiLCAoZGF0YSkgPT4ge1xuICBhcGkuY3JlYXRlQ2FyZCh7IG5hbWU6IGRhdGEuZGVzY3JpcHRpb24sIGxpbms6IGRhdGEubGluayB9KS50aGVuKChyZXMpID0+IHtcbiAgICByZW5kZXJDYXJkKHJlcyk7XG4gIH0pO1xufSk7XG5hZGRDYXJkTW9kYWwuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcblxuY29uc3QgcmVuZGVyQ2FyZCA9IChkYXRhKSA9PiB7XG4gIGNvbnN0IGNhcmQgPSBjcmVhdGVOZXdDYXJkKGRhdGEpO1xuICBlbGVtZW50TGlzdC5wcmVwZW5kKGNhcmQpO1xufTtcblxuYXBpLmdldFVzZXJJbmZvKCkudGhlbigocmVzKSA9PiB7XG4gIHVzZXJJZCA9IHJlcy5faWQ7XG4gIHVzZXJJbmZvLnNldFVzZXJJbmZvKHsgbmFtZTogcmVzLm5hbWUsIGFib3V0OiByZXMuYWJvdXQgfSk7XG59KTtcblxuYXBpLmdldEluaXRpYWxDYXJkcygpXG4udGhlbigocmVzKSA9PiB7XG4gIGNvbnNvbGUubG9nKFwicmVzXCIsIHJlcyk7XG4gIGNvbnN0IHNlY3Rpb24gPSBuZXcgU2VjdGlvbihcbiAgICB7XG4gICAgICBpdGVtczogcmVzLCBcbiAgICAgIHJlbmRlcmVyOiByZW5kZXJDYXJkLFxuICAgIH0sXG4gICAgXCIuZWxlbWVudHNfX2xpc3RcIlxuICApO1xuICBzZWN0aW9uLnJlbmRlcigpO1xufSk7XG5cbmNvbnN0IHVzZXJJbmZvID0gbmV3IFVzZXJJbmZvKHtcbiAgcHJvZmlsZU5hbWVTZWxlY3RvcjogXCIucHJvZmlsZV9fYXV0aG9yXCIsXG4gIHByb2ZpbGVKb2JTZWxlY3RvcjogXCIucHJvZmlsZV9fdGV4dFwiLFxufSk7XG5cbmZ1bmN0aW9uIGNyZWF0ZU5ld0NhcmQoZGF0YSkge1xuICBjb25zdCBjYXJkID0gbmV3IENhcmQoXG4gICAgZGF0YSxcbiAgICBcIiNjYXJkLXRlbXBsYXRlXCIsXG4gICAgKG5hbWUsIGxpbmspID0+IGltYWdlTW9kYWwub3BlbihuYW1lLCBsaW5rKSwgXG4gICAgKGlkKSA9PiB7XG4gICAgICBjb25maXJtTW9kYWwub3BlbigpO1xuICAgICAgY29uZmlybU1vZGFsLnNldEFjdGlvbigoKSA9PiB7XG4gICAgICAgIGFwaS5kZWxldGVDYXJkKGlkKS50aGVuKChyZXMpID0+IHtcbiAgICAgICAgICBjb25zb2xlLmxvZyhcIlRoaXMgY2FyZCB3YXMgZGVsZXRlZFwiLCByZXMpO1xuICAgICAgICAgIGNhcmQucmVtb3ZlQ2FyZCgpO1xuICAgICAgICB9KTtcbiAgICAgIH0pO1xuICAgIH0sXG4gICAgKGlkKSA9PiB7XG4gICAgICBhcGkubGlrZUNhcmQoaWQpXG4gICAgICAudGhlbihyZXMgPT4ge1xuICAgICAgICBjYXJkLmxpa2VDYXJkKHJlcy5saWtlcyk7XG4gICAgICAgIGNvbnNvbGUubG9nKFwicmVzXCIsIHJlcyk7XG4gICAgICB9KVxuICAgIH0sIHVzZXJJZFxuICApXG4gIGNvbnN0IGNhcmRFbGVtZW50ID0gY2FyZC5nZW5lcmF0ZUNhcmQoKTtcbiAgcmV0dXJuIGNhcmRFbGVtZW50O1xufVxuXG5mdW5jdGlvbiBmaWxsUHJvZmlsZUZvcm0oKSB7XG4gIGNvbnN0IHVzZXJEYXRhID0gdXNlckluZm8uZ2V0VXNlckluZm8oKTtcbiAgcHJvZmlsZUlucHV0TmFtZS52YWx1ZSA9IHVzZXJEYXRhLm5hbWU7XG4gIHByb2ZpbGVJbnB1dEFib3V0LnZhbHVlID0gdXNlckRhdGEuam9iO1xufVxuXG5lZGl0UHJvZmlsZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICBwcm9maWxlRm9ybVZhbGlkYXRvci5yZXNldFZhbGlkYXRpb24ocHJvZmlsZUZvcm0pO1xuICBmaWxsUHJvZmlsZUZvcm0oKTtcbiAgZWRpdE1vZGFsLm9wZW4oKTtcbn0pO1xuXG5wbHVzUHJvZmlsZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICBjYXJkRm9ybVZhbGlkYXRvci5yZXNldFZhbGlkYXRpb24oY2FyZEZvcm0pO1xuICBhZGRDYXJkTW9kYWwub3BlbigpO1xufSk7XG4iLCJpbXBvcnQgUG9wdXAgZnJvbSBcIi4vUG9wdXBcIjtcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXBXaXRoU3VibWl0IGV4dGVuZHMgUG9wdXAge1xuc2V0QWN0aW9uKGFjdGlvbikge1xudGhpcy5fc3VibWl0SGFuZGxlciA9IGFjdGlvblxudGhpcy5fZm9ybSA9IHRoaXMuX3BvcHVwLnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXBfX2Zvcm1cIik7XG59XG4gICAgXG5fZ2V0SW5wdXRWYWx1ZXMoKSB7XG4gICAgY29uc3QgaW5wdXRWYWx1ZXMgPSB7fTtcbiAgICBjb25zdCBpbnB1dHMgPSBbLi4udGhpcy5fZm9ybS5xdWVyeVNlbGVjdG9yQWxsKFwiLnBvcHVwX19pbnB1dFwiKV07XG4gICAgaW5wdXRzLmZvckVhY2goKGlucHV0KSA9PiB7XG4gICAgICBpbnB1dFZhbHVlc1tpbnB1dC5uYW1lXSA9IGlucHV0LnZhbHVlO1xuICAgIH0pO1xuICAgIHJldHVybiBpbnB1dFZhbHVlcztcbiAgfVxuXG5zZXRFdmVudExpc3RlbmVycygpIHtcbiAgICB0aGlzLl9wb3B1cC5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIChlKSA9PiB7XG4gICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICB0aGlzLl9zdWJtaXRIYW5kbGVyKHRoaXMuX2dldElucHV0VmFsdWVzKCkpO1xuICAgICAgdGhpcy5jbG9zZSgpO1xuICAgIH0pO1xuICAgIHN1cGVyLnNldEV2ZW50TGlzdGVuZXJzKCk7XG4gIH1cbn0iLCJpbXBvcnQgUG9wdXAgZnJvbSBcIi4vUG9wdXBcIjtcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXBXaXRoSW1hZ2UgZXh0ZW5kcyBQb3B1cCB7XG4gIG9wZW4obmFtZSwgbGluaykge1xuICAgIGNvbnN0IGltYWdlID0gdGhpcy5fcG9wdXAucXVlcnlTZWxlY3RvcihcIi5wb3B1cF9faW1hZ2VcIik7XG4gICAgY29uc3QgY2FwdGlvbiA9IHRoaXMuX3BvcHVwLnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXBfX2Rlc2NyaXB0aW9uXCIpO1xuICAgIGNhcHRpb24udGV4dENvbnRlbnQgPSBuYW1lO1xuICAgIGltYWdlLmFsdCA9IGBQaG90byBvZiAke25hbWV9YDtcbiAgICBpbWFnZS5zcmMgPSBsaW5rO1xuICAgIHN1cGVyLm9wZW4oKTtcbiAgfVxufVxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgVXNlckluZm8ge1xuICBjb25zdHJ1Y3Rvcih7IHByb2ZpbGVOYW1lU2VsZWN0b3IsIHByb2ZpbGVKb2JTZWxlY3RvciB9KSB7XG4gICAgdGhpcy5fcHJvZmlsZU5hbWUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHByb2ZpbGVOYW1lU2VsZWN0b3IpO1xuICAgIHRoaXMuX3Byb2ZpbGVKb2IgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHByb2ZpbGVKb2JTZWxlY3Rvcik7XG4gIH1cbiAgZ2V0VXNlckluZm8oKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIG5hbWU6IHRoaXMuX3Byb2ZpbGVOYW1lLnRleHRDb250ZW50LFxuICAgICAgam9iOiB0aGlzLl9wcm9maWxlSm9iLnRleHRDb250ZW50LFxuICAgIH07XG4gIH1cbiAgc2V0VXNlckluZm8oeyBuYW1lLCBhYm91dCB9KSB7XG4gICAgdGhpcy5fcHJvZmlsZU5hbWUudGV4dENvbnRlbnQgPSBuYW1lO1xuICAgIHRoaXMuX3Byb2ZpbGVKb2IudGV4dENvbnRlbnQgPSBhYm91dDtcbiAgfVxufVxuIl0sIm5hbWVzIjpbIl9fd2VicGFja19tb2R1bGVfY2FjaGVfXyIsIl9fd2VicGFja19yZXF1aXJlX18iLCJtb2R1bGVJZCIsImNhY2hlZE1vZHVsZSIsInVuZGVmaW5lZCIsImV4cG9ydHMiLCJtb2R1bGUiLCJfX3dlYnBhY2tfbW9kdWxlc19fIiwicCIsIkNhcmQiLCJjb25zdHJ1Y3RvciIsImRhdGEiLCJjYXJkU2VsZWN0b3IiLCJoYW5kbGVDYXJkQ2xpY2siLCJoYW5kbGVEZWxldGVCdXR0b24iLCJoYW5kbGVMaWtlQnV0dG9uIiwidXNlcklkIiwidGhpcyIsIl9lbGVtZW50IiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwiX2NhcmRTZWxlY3RvciIsImNvbnRlbnQiLCJjbG9uZU5vZGUiLCJyZW1vdmUiLCJfZWxlbWVudEJpbiIsImFkZEV2ZW50TGlzdGVuZXIiLCJfaGFuZGxlRGVsZXRlQnV0dG9uIiwiX2lkIiwiX2xpa2VCdXR0b24iLCJfaGFuZGxlTGlrZUJ1dHRvbiIsIl9lbGVtZW50UGljdHVyZSIsIl9oYW5kbGVDYXJkQ2xpY2siLCJfbmFtZSIsIl9saW5rIiwiX2dldFRlbXBsYXRlIiwiX3NldEV2ZW50TGlzdGVuZXJzIiwic3JjIiwiYWx0IiwidGV4dENvbnRlbnQiLCJfb3duZXJJZCIsIl91c2VySWQiLCJzdHlsZSIsImRpc3BsYXkiLCJfbGlrZXMiLCJsZW5ndGgiLCJzb21lIiwicGVyc29uIiwibGlrZUNhcmQiLCJuYW1lIiwibGluayIsIm93bmVyIiwibGlrZXMiLCJuZXdMaWtlcyIsImNsYXNzTGlzdCIsImFkZCIsIlBvcHVwIiwicG9wdXBTZWxlY3RvciIsIl9wb3B1cCIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJfaGFuZGxlRXNjYXBlQ2xvc2UiLCJlIiwia2V5IiwiY2xvc2UiLCJvcGVuIiwic2V0RXZlbnRMaXN0ZW5lcnMiLCJ0YXJnZXQiLCJjb250YWlucyIsIlBvcHVwV2l0aEZvcm0iLCJoYW5kbGVTdWJtaXQiLCJzdXBlciIsIl9oYW5kbGVTdWJtaXQiLCJfZm9ybSIsIl9nZXRJbnB1dFZhbHVlcyIsImlucHV0VmFsdWVzIiwicXVlcnlTZWxlY3RvckFsbCIsImZvckVhY2giLCJpbnB1dCIsInZhbHVlIiwicHJldmVudERlZmF1bHQiLCJyZXNldCIsIlNlY3Rpb24iLCJjb250YWluZXJTZWxlY3RvciIsIml0ZW1zIiwicmVuZGVyZXIiLCJfaXRlbXMiLCJfcmVuZGVyZXIiLCJfY29udGFpbmVyIiwiYWRkSXRlbSIsImVsZW1lbnQiLCJwcmVwZW5kIiwicmVuZGVyIiwiRm9ybVZhbGlkYXRvciIsInNldHRpbmdzIiwiZm9ybUVsZW1lbnQiLCJpbnB1dEVsZW1lbnQiLCJfZXJyb3JFbGVtZW50IiwiX2Zvcm1FbGVtZW50IiwiaWQiLCJfaW5wdXRFcnJvckNsYXNzIiwidmFsaWRhdGlvbk1lc3NhZ2UiLCJfZXJyb3JDbGFzcyIsInZhbGlkaXR5IiwidmFsaWQiLCJfaGlkZUlucHV0RXJyb3IiLCJfc2hvd0lucHV0RXJyb3IiLCJpbnB1dHNMaXN0IiwiQXJyYXkiLCJmcm9tIiwiX2hhc0ludmFsaWRJbnB1dCIsIl9pbnB1dHNMaXN0IiwiX2VsZW1lbnRCdXR0b24iLCJfaW5hY3RpdmVCdXR0b25DbGFzcyIsInNldEF0dHJpYnV0ZSIsInJlbW92ZUF0dHJpYnV0ZSIsIl9pbnB1dFNlbGVjdG9yIiwiX3RvZ2dsZUJ1dHRvblN0YXRlIiwiX2NoZWNrSW5wdXRWYWxpZGl0eSIsImV2dCIsImlucHV0U2VsZWN0b3IiLCJfc3VibWl0QnV0dG9uU2VsZWN0b3IiLCJzdWJtaXRCdXR0b25TZWxlY3RvciIsImluYWN0aXZlQnV0dG9uQ2xhc3MiLCJpbnB1dEVycm9yQ2xhc3MiLCJlcnJvckNsYXNzIiwicGFnZVNldHRpbmdzIiwiZm9ybVNlbGVjdG9yIiwiY3VzdG9tRmV0Y2giLCJ1cmwiLCJoZWFkZXJzIiwiZmV0Y2giLCJ0aGVuIiwicmVzIiwib2siLCJqc29uIiwiUHJvbWlzZSIsInJlamVjdCIsInN0YXR1c1RleHQiLCJjYXRjaCIsImNvbnNvbGUiLCJsb2ciLCJhcGkiLCJiYXNlVXJsIiwiX2Jhc2VVcmwiLCJfaGVhZGVycyIsImdldEluaXRpYWxDYXJkcyIsImdldFVzZXJJbmZvIiwiY3JlYXRlQ2FyZCIsIm1ldGhvZCIsImJvZHkiLCJKU09OIiwic3RyaW5naWZ5IiwiZGVsZXRlQ2FyZCIsImNhcmRJZCIsImF1dGhvcml6YXRpb24iLCJwbHVzUHJvZmlsZUJ1dHRvbiIsInByb2ZpbGVGb3JtIiwiZWRpdFByb2ZpbGVCdXR0b24iLCJjYXJkRm9ybSIsImVsZW1lbnRMaXN0IiwicHJvZmlsZUlucHV0TmFtZSIsInByb2ZpbGVJbnB1dEFib3V0IiwiZ2V0RWxlbWVudEJ5SWQiLCJoZWFkZXJTcmMiLCJwcm9maWxlU3JjIiwiY2FyZEZvcm1WYWxpZGF0b3IiLCJlbmFibGVWYWxpZGF0aW9uIiwicHJvZmlsZUZvcm1WYWxpZGF0b3IiLCJjb25maXJtTW9kYWwiLCJzZXRBY3Rpb24iLCJhY3Rpb24iLCJfc3VibWl0SGFuZGxlciIsImltYWdlTW9kYWwiLCJpbWFnZSIsImVkaXRNb2RhbCIsInVzZXJJbmZvIiwic2V0VXNlckluZm8iLCJhZGRDYXJkTW9kYWwiLCJkZXNjcmlwdGlvbiIsInJlbmRlckNhcmQiLCJjYXJkIiwicmVtb3ZlQ2FyZCIsImdlbmVyYXRlQ2FyZCIsImNyZWF0ZU5ld0NhcmQiLCJhYm91dCIsInByb2ZpbGVOYW1lU2VsZWN0b3IiLCJwcm9maWxlSm9iU2VsZWN0b3IiLCJfcHJvZmlsZU5hbWUiLCJfcHJvZmlsZUpvYiIsImpvYiIsInJlc2V0VmFsaWRhdGlvbiIsInVzZXJEYXRhIiwiZmlsbFByb2ZpbGVGb3JtIl0sInNvdXJjZVJvb3QiOiIifQ==